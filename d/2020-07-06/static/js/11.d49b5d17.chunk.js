/*! For license information please see 11.d49b5d17.chunk.js.LICENSE.txt */
(this["webpackJsonpremote-faces-web"]=this["webpackJsonpremote-faces-web"]||[]).push([[11],{60:function(t,e,i){!function(t){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,i)};function i(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}var o=function(){return(o=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=function(t){function e(e,i){var o=this.constructor,r=t.call(this,e)||this;return r.__proto__=o.prototype,r.name=r.name="SGFSyntaxError",r.message=e||"There was an unspecified syntax error in the SGF",i&&(r.message+=" on line "+i.lineNo+", char "+i.charNo+":\n",r.message+="\t"+i.sgfString.split("\n")[i.lineNo-1]+"\n",r.message+="\t"+Array(i.charNo+1).join(" ")+"^"),r}return i(e,t),e}(Error),n="A".charCodeAt(0),s="Z".charCodeAt(0),a=" ".charCodeAt(0);function h(t){if(!t)return!1;var e=t.charCodeAt(0);return e>=n&&e<=s}var p,c=function(){function t(t){this.position=0,this.lineNo=1,this.charNo=0,this.sgfString=t}return t.prototype.currentChar=function(){for(;this.sgfString.charCodeAt(this.position)<=a;)this.nextChar();return this.sgfString[this.position]},t.prototype.nextChar=function(){return"\n"===this.sgfString[this.position]?(this.charNo=0,this.lineNo++):this.charNo++,this.position++,this.sgfString[this.position]},t.prototype.processChar=function(t){if(this.currentChar()!==t)throw new r("Unexpected character "+this.currentChar()+". Character "+t+" was expected.",this);return this.nextChar()},t.prototype.parsePropertyValue=function(t){if(!t||"["===this.currentChar()){for(var e="",i=this.processChar("[");"]"!==i;){if(!i)throw new r("End of SGF inside of property",this);if("\\"===i){if(!(i=this.nextChar()))throw new r("End of SGF inside of property",this);if("\n"===i)continue}e+=i,i=this.nextChar()}return this.processChar("]"),e}},t.prototype.parsePropertyIdent=function(){var t="",e=this.currentChar();if(!h(e))throw new r("Property identifier must consists from upper case letters.",this);for(t+=e;(e=this.nextChar())&&h(e);)t+=e;return t},t.prototype.parsePropertyValues=function(){var t=[],e=this.parsePropertyValue();for(e&&t.push(e);e=this.parsePropertyValue(!0);)t.push(e);return t},t.prototype.parseProperty=function(){if(h(this.currentChar()))return[this.parsePropertyIdent(),this.parsePropertyValues()]},t.prototype.parseNode=function(){this.processChar(";");for(var t,e={};t=this.parseProperty();)e[t[0]]=t[1];return e},t.prototype.parseSequence=function(){var t=[];for(t.push(this.parseNode());";"===this.currentChar();)t.push(this.parseNode());return t},t.prototype.parseGameTree=function(){this.processChar("(");var t=this.parseSequence(),e=[];return"("===this.currentChar()&&(e=this.parseCollection()),this.processChar(")"),{sequence:t,children:e}},t.prototype.parseCollection=function(){var t=[];for(t.push(this.parseGameTree());"("===this.currentChar();)t.push(this.parseGameTree());return t},t}(),l=function(t){this.zIndex=0,this.type=t},u=function(t){function e(e){var i=t.call(this,e)||this;return i.x=0,i.y=0,i.scaleX=1,i.scaleY=1,i.rotate=0,i}return i(e,t),e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setScale=function(t){this.scaleX=t,this.scaleY=t},e.prototype.setOpacity=function(t){this.opacity=t},e}(l);(p=t.Color||(t.Color={}))[p.BLACK=1]="BLACK",p[p.B=1]="B",p[p.WHITE=-1]="WHITE",p[p.W=-1]="W",p[p.EMPTY=0]="EMPTY",p[p.E=0]="E";var f=function(e){function o(i,o){void 0===o&&(o=t.Color.E);var r=e.call(this,i)||this;return r.variation=o,r}return i(o,e),o}(u),d=function(t){function e(e,i){var o=t.call(this,"LB",i)||this;return o.text=e,o}return i(e,t),e}(f),y=function(t){function e(e,i,o){var r=t.call(this,e)||this;return r.start=i,r.end=o,r}return i(e,t),e}(u),g=function(){function t(t){this.board=t,this.init()}return t.prototype.init=function(){this.element=document.createElement("canvas"),this.element.style.position="absolute",this.element.style.width="100%",this.element.style.height="100%",this.context=this.element.getContext("2d"),this.context.scale(this.board.pixelRatio,this.board.pixelRatio),this.context.save(),this.board.boardElement.appendChild(this.element)},t.prototype.resize=function(t,e){var i=this.board.config.theme.linesShift;this.element.width=t,this.element.height=e,this.context.transform(1,0,0,1,i,i)},t.prototype.draw=function(t,e){var i=this;try{if(this.context.save(),e instanceof u){var o=this.board.getX(e.x),r=this.board.getY(e.y),n=this.board.fieldSize;this.context.transform(n*e.scaleX,0,0,n*e.scaleY,o,r),this.context.rotate(e.rotate),this.context.globalAlpha=e.opacity}else o=this.board.getX(0),r=this.board.getY(0),n=this.board.fieldSize,this.context.transform(n,0,0,n,o,r);var s=t(this.context,this.board.config,e);this.context.restore(),s&&s.then&&s.then((function(){i.board.redraw()}))}catch(a){console.error("Object couldn't be rendered. Error: "+a.message,e)}},t.prototype.clear=function(){this.context.clearRect(0,0,this.element.width,this.element.height)},t}(),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.context.transform(1,0,0,1,this.board.config.theme.shadowOffsetX*this.board.fieldSize,this.board.config.theme.shadowOffsetY*this.board.fieldSize)},e}(g),v=function(t){void 0===t&&(t={}),this.params=t},b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.shadow=function(t,e){var i=e.theme.stoneSize,o=e.theme.shadowBlur,r=Math.max(i-i*o,1e-5),n=i+1/7*i*o,s=t.createRadialGradient(0,0,r,0,0,n);s.addColorStop(0,e.theme.shadowColor),s.addColorStop(1,e.theme.shadowTransparentColor),t.beginPath(),t.fillStyle=s,t.arc(0,0,n,0,2*Math.PI,!0),t.fill()},e}(v),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize;t.beginPath(),t.fillStyle="#000",t.arc(0,0,i,0,2*Math.PI,!0),t.fill();var o=t.createRadialGradient(.4*i,.4*i,0,.5*i,.5*i,i);o.addColorStop(0,"rgba(32,32,32,1)"),o.addColorStop(1,"rgba(0,0,0,0)"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill(),(o=t.createRadialGradient(-.4*i,-.4*i,.05*i,-.5*i,-.5*i,1.5*i)).addColorStop(0,"rgba(64,64,64,1)"),o.addColorStop(1,"rgba(0,0,0,0)"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill()},e}(b),w=Math.ceil(9999999*Math.random()),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e,i){var o=e.theme.stoneSize;t.beginPath(),t.fillStyle="#aaa",t.arc(0,0,o,0,2*Math.PI,!0),t.fill();var r=w%(3+i.x*e.size+i.y)%3,n=e.size*e.size+i.x*e.size+i.y,s=2/n*(w%n);0===r?this.drawShell({ctx:t,x:0,y:0,radius:o,angle:s,lines:[.1,.12,.11,.1,.09,.09,.09,.09],factor:.25,thickness:1.75}):1===r?this.drawShell({ctx:t,x:0,y:0,radius:o,angle:s,lines:[.1,.09,.08,.07,.06,.06,.06,.06,.06,.06,.06],factor:.2,thickness:1.5}):this.drawShell({ctx:t,x:0,y:0,radius:o,angle:s,lines:[.12,.14,.13,.12,.12,.12],factor:.3,thickness:2});var a=t.createRadialGradient(-2*o/5,-2*o/5,o/3,-o/5,-o/5,5*o/5);a.addColorStop(0,"rgba(255,255,255,0.9)"),a.addColorStop(1,"rgba(255,255,255,0)"),t.beginPath(),t.fillStyle=a,t.arc(0,0,o,0,2*Math.PI,!0),t.fill()},e.prototype.drawShell=function(t){for(var e=t.angle,i=t.angle,o=0;o<t.lines.length;o++)e+=t.lines[o],i-=t.lines[o],this.drawShellLine(t.ctx,t.x,t.y,t.radius,e,i,t.factor,t.thickness)},e.prototype.drawShellLine=function(t,e,i,o,r,n,s,a){t.strokeStyle="rgba(64,64,64,0.2)",t.lineWidth=o/30*a,t.beginPath();var h,p,c,l,u=.9*o,f=e+u*Math.cos(r*Math.PI),d=i+u*Math.sin(r*Math.PI),y=e+u*Math.cos(n*Math.PI),g=i+u*Math.sin(n*Math.PI);y>f?(h=(g-d)/(y-f),p=Math.atan(h)):y===f?p=Math.PI/2:(h=(g-d)/(y-f),p=Math.atan(h)-Math.PI);var m=s*u,v=f+(c=Math.sin(p)*m),b=d-(l=Math.cos(p)*m),x=y+c,w=g-l;t.moveTo(f,d),t.bezierCurveTo(v,b,x,w,y,g),t.stroke()},e}(b),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize,o=t.createRadialGradient(-2*i/5,-2*i/5,1,-i/5,-i/5,4*i/5);o.addColorStop(0,"#666"),o.addColorStop(1,"#000"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill()},e}(b),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize,o=t.createRadialGradient(-2*i/5,-2*i/5,i/3,-i/5,-i/5,5*i/5);o.addColorStop(0,"#fff"),o.addColorStop(1,"#aaa"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill()},e}(b),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize,o=t.createRadialGradient(-2*i/5,-2*i/5,1*i/5,-i/5,-i/5,4*i/5);o.addColorStop(0,"#111"),o.addColorStop(1,"#000"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.lineWidth=i/6,t.strokeStyle="#ccc",t.arc(-i/8,-i/8,i/2,Math.PI,1.5*Math.PI),t.stroke()},e}(b),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize,o=t.createRadialGradient(-2*i/5,-2*i/5,2*i/5,-i/5,-i/5,4*i/5);o.addColorStop(0,"#fff"),o.addColorStop(1,"#ddd"),t.beginPath(),t.fillStyle=o,t.arc(0,0,i,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.lineWidth=i/6,t.strokeStyle="#999",t.arc(i/8,i/8,i/2,0,Math.PI/2,!1),t.stroke()},e}(b),O=function(t){function e(e){return t.call(this,{color:e})||this}return i(e,t),e.prototype.stone=function(t,e){var i=e.theme.stoneSize,o=e.theme.markupLineWidth;t.fillStyle=this.params.color,t.beginPath(),t.arc(0,0,i-o/2,0,2*Math.PI,!0),t.fill(),t.lineWidth=o,t.strokeStyle="black",t.stroke()},e}(v),T=function(t){function e(e,i){var o=t.call(this)||this;return o.fallback=i,o.randSeed=Math.ceil(9999999*Math.random()),o.images={},o.paths=e,o}return i(e,t),e.prototype.loadImage=function(t){return new Promise((function(e,i){var o=new Image;o.onload=function(){e(o)},o.onerror=function(){i()},o.src=t}))},e.prototype.stone=function(t,e,i){var o=this,r=this.paths.length;if(r){var n=e.theme.stoneSize,s=this.randSeed%(r+i.x*e.size+i.y)%r;if(!this.images[this.paths[s]]){this.fallback.stone(t,e,i);var a=this.paths[s];return this.loadImage(a).then((function(t){o.images[a]=t})).catch((function(){o.paths=o.paths.filter((function(t){return t!==a}))}))}t.drawImage(this.images[this.paths[s]],-n,-n,2*n,2*n)}else this.fallback.stone(t,e,i)},e}(b),M=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return i(o,e),o.prototype.grid=function(e,i,o){o.variation===t.Color.E&&e.clearRect(-i.theme.stoneSize,-i.theme.stoneSize,2*i.theme.stoneSize,2*i.theme.stoneSize)},o.prototype.getColor=function(e,i){return this.params.color?this.params.color:i.variation===t.Color.B?e.theme.markupBlackColor:i.variation===t.Color.W?e.theme.markupWhiteColor:e.theme.markupNoneColor},o}(v),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e,i){t.strokeStyle=this.getColor(e,i),t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle,t.beginPath(),this.drawShape(t),t.stroke(),this.params.fillColor&&(t.fillStyle=this.params.fillColor,t.fill())},e}(M),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawShape=function(t){t.arc(0,0,.25,0,2*Math.PI,!0)},e}(z),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawShape=function(t){t.rect(-.25,-.25,.5,.5)},e}(z),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawShape=function(t){t.moveTo(0,-.25),t.lineTo(-.25,.166666),t.lineTo(.25,.166666),t.closePath()},e}(z),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e,i){var o=this.params.font||e.theme.font||"";t.fillStyle=this.getColor(e,i),t.shadowBlur=10,t.shadowColor=t.fillStyle;var r=.5;1===i.text.length?r=.75:2===i.text.length&&(r=.6),t.beginPath(),t.textBaseline="middle",t.textAlign="center",t.font=r+"px "+o,t.fillText(i.text,0,.02+.08*(r-.5),1)},e}(M),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t){t.fillStyle=this.params.color,t.shadowBlur=10,t.shadowColor=t.fillStyle,t.beginPath(),t.arc(0,0,.15,0,2*Math.PI,!0),t.fill()},e}(v),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.drawShape=function(t){t.moveTo(-.2,-.2),t.lineTo(.2,.2),t.moveTo(.2,-.2),t.lineTo(-.2,.2)},e}(z),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e,i){t.strokeStyle=this.params.color?this.params.color:e.theme.markupNoneColor,t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle,t.beginPath(),t.moveTo(i.start.x,i.start.y),t.lineTo(i.end.x,i.end.y),t.stroke()},e}(v),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t,e,i){t.strokeStyle=this.params.color?this.params.color:e.theme.markupNoneColor,t.fillStyle=t.strokeStyle,t.lineWidth=this.params.lineWidth||e.theme.markupLineWidth,t.shadowBlur=10,t.shadowColor=t.strokeStyle;var o=i.start.x,r=i.start.y,n=i.end.x,s=i.end.y,a=Math.sqrt((n-o)*(n-o)+(s-r)*(s-r)),h=function(t){return o+t*(n-o)},p=function(t){return r+t*(s-r)},c=1/a/2.5,l=h(1-c),u=p(1-c),f=function(t){return l+t*(s-r)},d=function(t){return u+t*(o-n)};t.beginPath(),t.arc(o,r,.1,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.moveTo(h(1/a*.1),p(1/a*.1)),t.lineTo(l,u),t.stroke(),t.beginPath(),t.moveTo(f(-c/1.75),d(-c/1.75)),t.lineTo(f(c/1.75),d(c/1.75)),t.lineTo(n,s),t.closePath(),t.fill()},e}(v),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stone=function(t){t.fillStyle=this.params.color,t.fillRect(-.5,-.5,1,1)},e}(v),j=Object.freeze({DrawHandler:v,ShellStoneBlack:x,ShellStoneWhite:S,GlassStoneBlack:C,GlassStoneWhite:E,PaintedStoneBlack:N,PaintedStoneWhite:P,SimpleStone:O,RealisticStone:T,Circle:A,Square:k,Triangle:L,Label:I,Dot:R,XMark:B,Line:_,Arrow:W,Stone:b,MarkupDrawHandler:M,ShapeMarkup:z,Dim:G}),D={stoneSize:.47,markupBlackColor:"rgba(255,255,255,0.9)",markupWhiteColor:"rgba(0,0,0,0.7)",markupNoneColor:"rgba(0,0,0,0.7)",markupLineWidth:.05,shadowColor:"rgba(62,32,32,0.5)",shadowTransparentColor:"rgba(62,32,32,0)",shadowBlur:.25,shadowOffsetX:.07,shadowOffsetY:.13,font:"calibri",linesShift:-.5,backgroundColor:"#CEB053",backgroundImage:"",grid:{linesWidth:.03,linesColor:"#654525",starColor:"#531",starSize:.07},coordinates:{color:"#531",bold:!1,x:"ABCDEFGHJKLMNOPQRSTUVWXYZ",y:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},drawHandlers:{B:new O("#222"),W:new O("#eee"),CR:new A,SQ:new k,LB:new I,TR:new L,MA:new B({lineWidth:.075}),SL:new R({color:"rgba(32, 32, 192, 0.75)"}),LN:new _,AR:new W,DD:new G({color:"rgba(0, 0, 0, 0.5)"})}},H=o({},D,{font:"calibri",backgroundImage:"images/wood1.jpg",stoneSize:.48,drawHandlers:o({},D.drawHandlers,{B:new T(["images/stones/black00_128.png","images/stones/black01_128.png","images/stones/black02_128.png","images/stones/black03_128.png"],new C),W:new T(["images/stones/white00_128.png","images/stones/white01_128.png","images/stones/white02_128.png","images/stones/white03_128.png","images/stones/white04_128.png","images/stones/white05_128.png","images/stones/white06_128.png","images/stones/white07_128.png","images/stones/white08_128.png","images/stones/white09_128.png","images/stones/white10_128.png"],new E)})}),K=o({},D,{font:"calibri",backgroundImage:"",drawHandlers:o({},D.drawHandlers,{B:new x,W:new S})}),F=Object.freeze({baseTheme:D,realisticTheme:H,modernTheme:K}),V={size:19,width:0,height:0,starPoints:{5:[{x:2,y:2}],7:[{x:3,y:3}],8:[{x:2,y:2},{x:5,y:2},{x:2,y:5},{x:5,y:5}],9:[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}],10:[{x:2,y:2},{x:7,y:2},{x:2,y:7},{x:7,y:7}],11:[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}],12:[{x:3,y:3},{x:8,y:3},{x:3,y:8},{x:8,y:8}],13:[{x:3,y:3},{x:9,y:3},{x:6,y:6},{x:3,y:9},{x:9,y:9}],14:[{x:3,y:3},{x:10,y:3},{x:3,y:10},{x:10,y:10}],15:[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}],16:[{x:3,y:3},{x:12,y:3},{x:3,y:12},{x:12,y:12}],17:[{x:3,y:3},{x:8,y:3},{x:13,y:3},{x:3,y:8},{x:8,y:8},{x:13,y:8},{x:3,y:13},{x:8,y:13},{x:13,y:13}],18:[{x:3,y:3},{x:14,y:3},{x:3,y:14},{x:14,y:14}],19:[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],20:[{x:3,y:3},{x:16,y:3},{x:3,y:16},{x:16,y:16}],21:[{x:3,y:3},{x:10,y:3},{x:17,y:3},{x:3,y:10},{x:10,y:10},{x:17,y:10},{x:3,y:17},{x:10,y:17},{x:17,y:17}]},viewport:{top:0,right:0,bottom:0,left:0},coordinates:!1,theme:D,marginSize:.25,snapToGrid:!1};function Y(t,e){var i={},o=Object.keys(t);return o.forEach((function(o){var r=e[o],n=t[o];null==r||r.constructor!==Object||Array.isArray(r)||null==n?i[o]=void 0!==r?r:n:i[o]=Y(n,r)})),Object.keys(e).forEach((function(t){-1===o.indexOf(t)&&(i[t]=e[t])})),i}var U,X=function(){function t(){this._events={}}return t.prototype.on=function(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)},t.prototype.off=function(t,e){this._events[t]&&(null==e&&(this._events[t]=[]),this._events[t]=this._events[t].filter((function(t){return t!==e})))},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._events[t]&&this._events[t].forEach((function(t){return t.apply(void 0,e)}))},t}(),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.drawGrid()},e.prototype.clear=function(){t.prototype.clear.call(this),this.drawGrid()},e.prototype.drawGrid=function(){var t,e=this.board.config.theme.grid;this.context.beginPath(),this.context.lineWidth=e.linesWidth*this.board.fieldSize,this.context.strokeStyle=e.linesColor;var i=Math.round(this.board.getX(0)),o=Math.round(this.board.getY(0)),r=Math.round((this.board.config.size-1)*this.board.fieldSize),n=Math.round((this.board.config.size-1)*this.board.fieldSize);this.context.strokeRect(i,o,r,n);for(var s=1;s<this.board.config.size-1;s++)t=Math.round(this.board.getX(s)),this.context.moveTo(t,o),this.context.lineTo(t,o+n),t=Math.round(this.board.getY(s)),this.context.moveTo(i,t),this.context.lineTo(i+r,t);if(this.context.stroke(),this.context.fillStyle=e.starColor,this.board.config.starPoints[this.board.config.size])for(var a in this.board.config.starPoints[this.board.config.size])this.context.beginPath(),this.context.arc(this.board.getX(this.board.config.starPoints[this.board.config.size][a].x),this.board.getY(this.board.config.starPoints[this.board.config.size][a].y),e.starSize*this.board.fieldSize,0,2*Math.PI,!0),this.context.fill();this.board.config.coordinates&&this.drawCoordinates()},e.prototype.drawCoordinates=function(){var t,e=this.board.config.theme.coordinates;this.context.fillStyle=e.color,this.context.textBaseline="middle",this.context.textAlign="center",this.context.font=(e.bold?"bold ":"")+this.board.fieldSize/2+"px "+(this.board.config.theme.font||"");for(var i=this.board.getX(-.75),o=this.board.getX(this.board.config.size-.25),r=this.board.getY(-.75),n=this.board.getY(this.board.config.size-.25),s=e.x,a=e.y,h=0;h<this.board.config.size;h++)t=this.board.getY(h),this.context.fillText(s[h],i,t),this.context.fillText(s[h],o,t),t=this.board.getX(h),this.context.fillText(a[h],t,r),this.context.fillText(a[h],t,n);this.context.fillStyle="black"},e}(g),Z=function(t,e){return t.zIndex-e.zIndex},J=function(t){function e(e,i){void 0===i&&(i={});var o=t.call(this)||this;return o.objects=[],o.config=Y(V,i),o.init(e),o.pixelRatio=window.devicePixelRatio||1,o.resize(),o}return i(e,t),e.prototype.init=function(t){this.element=document.createElement("div"),this.element.className="wgo-board",this.element.style.position="relative",t.appendChild(this.element),this.boardElement=document.createElement("div"),this.boardElement.style.position="absolute",this.boardElement.style.left="0",this.boardElement.style.top="0",this.boardElement.style.right="0",this.boardElement.style.bottom="0",this.boardElement.style.margin="auto",this.element.appendChild(this.boardElement),this.layers={grid:new q(this),shadow:new m(this),stone:new g(this)}},e.prototype.resize=function(){var t=this,e=this.config.size-this.config.viewport.left-this.config.viewport.right,i=this.config.size-this.config.viewport.top-this.config.viewport.bottom,o=this.config.marginSize+(this.config.coordinates&&!this.config.viewport.top?.5:0),r=this.config.marginSize+(this.config.coordinates&&!this.config.viewport.right?.5:0),n=this.config.marginSize+(this.config.coordinates&&!this.config.viewport.bottom?.5:0),s=this.config.marginSize+(this.config.coordinates&&!this.config.viewport.left?.5:0);this.config.width&&this.config.height?(this.width=this.config.width*this.pixelRatio,this.height=this.config.height*this.pixelRatio,this.fieldSize=Math.min(this.width/(e+s+r),this.height/(i+o+n)),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):this.config.width?(this.width=this.config.width*this.pixelRatio,this.fieldSize=this.width/(e+s+r),this.height=this.fieldSize*(i+o+n),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):this.config.height?(this.height=this.config.height*this.pixelRatio,this.fieldSize=this.height/(i+o+n),this.width=this.fieldSize*(e+s+r),this.resizeCallback&&window.removeEventListener("resize",this.resizeCallback)):(this.element.style.width="auto",this.width=this.element.offsetWidth*this.pixelRatio,this.fieldSize=this.width/(e+s+r),this.height=this.fieldSize*(i+o+n),this.resizeCallback||(this.resizeCallback=function(){t.resize()},window.addEventListener("resize",this.resizeCallback))),this.config.snapToGrid&&(this.fieldSize=Math.floor(this.fieldSize)),this.leftOffset=this.fieldSize*(s+.5-this.config.viewport.left),this.topOffset=this.fieldSize*(o+.5-this.config.viewport.top),this.element.style.width=this.width/this.pixelRatio+"px",this.element.style.height=this.height/this.pixelRatio+"px";var a=(e+s+r)*this.fieldSize,h=(i+o+n)*this.fieldSize;this.boardElement.style.width=a/this.pixelRatio+"px",this.boardElement.style.height=h/this.pixelRatio+"px",Object.keys(this.layers).forEach((function(e){t.layers[e].resize(a,h)})),this.redraw()},e.prototype.getX=function(t){return this.leftOffset+t*this.fieldSize},e.prototype.getY=function(t){return this.topOffset+t*this.fieldSize},e.prototype.setWidth=function(t){this.config.width=t,this.config.height=0,this.resize()},e.prototype.setHeight=function(t){this.config.width=0,this.config.height=t,this.resize()},e.prototype.setDimensions=function(t,e){this.config.width=t,this.config.height=e,this.resize()},e.prototype.getViewport=function(){return this.config.viewport},e.prototype.setViewport=function(t){this.config.viewport=t,this.resize()},e.prototype.getSize=function(){return this.config.size},e.prototype.setSize=function(t){void 0===t&&(t=19),t!==this.config.size&&(this.config.size=t,this.resize())},e.prototype.getCoordinates=function(){return this.config.coordinates},e.prototype.setCoordinates=function(t){this.config.coordinates!==t&&(this.config.coordinates=t,this.resize())},e.prototype.redraw=function(){var t=this;this.redrawScheduled||(this.redrawScheduled=!0,window.requestAnimationFrame((function(){t.redrawScheduled=!1,t.boardElement.style.backgroundColor=t.config.theme.backgroundColor,t.config.theme.backgroundImage&&(t.boardElement.style.backgroundImage='url("'+t.config.theme.backgroundImage+'")'),t.objects.sort(Z),Object.keys(t.layers).forEach((function(e){t.layers[e].clear(),t.objects.forEach((function(i){var o="string"===typeof i.type?t.config.theme.drawHandlers[i.type]:i.type;o[e]&&t.layers[e].draw(o[e].bind(o),i)}))}))})))},e.prototype.addObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.addObject(t[e]);else{if("string"===typeof t.type){if(!this.config.theme.drawHandlers[t.type])throw new TypeError('Board object type "'+t.type+"\" doesn't exist in `config.theme.drawHandlers`.")}else if(null==t.type||!(t.type instanceof v))throw new TypeError("Invalid board object type.");this.objects.push(t),this.redraw()}},e.prototype.addObjectAt=function(t,e,i){i.setPosition(t,e),this.addObject(i)},e.prototype.removeObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.removeObject(t[e]);else{var i=this.objects.indexOf(t);-1!==i&&(this.objects.splice(i,1),this.redraw())}},e.prototype.removeObjectsAt=function(t,e){var i=this;this.objects.forEach((function(o){o instanceof u&&o.x===t&&o.y===e&&i.removeObject(o)}))},e.prototype.removeAllObjects=function(){this.objects=[],this.redraw()},e.prototype.hasObject=function(t){return this.objects.indexOf(t)>=0},e.prototype.on=function(e,i){t.prototype.on.call(this,e,i),this.registerBoardListener(e)},e.prototype.registerBoardListener=function(t){var e=this;this.boardElement.addEventListener(t,(function(i){if(null!=i.layerX){var o=e.getRelativeCoordinates(i.layerX,i.layerY);e.emit(t,i,o)}else e.emit(t,i)}))},e.prototype.getRelativeCoordinates=function(t,e){var i=Math.round((t*this.pixelRatio-this.leftOffset)/this.fieldSize),o=Math.round((e*this.pixelRatio-this.topOffset)/this.fieldSize);return i<0||i>=this.config.size||o<0||o>=this.config.size?null:{x:i,y:o}},e}(X);(U=t.Repeating||(t.Repeating={})).KO="KO",U.ALL="ALL",U.NONE="NONE";var Q={repeating:t.Repeating.KO,allowRewrite:!1,allowSuicide:!1,komi:6.5},$={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!1,komi:7.5},tt={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!0,komi:7.5},et={repeating:t.Repeating.ALL,allowRewrite:!0,allowSuicide:!0,komi:0},it={Japanese:Q,GOE:tt,NZ:tt,AGA:$,Chinese:$},ot=function(){function e(e){void 0===e&&(e=19),this.grid=[],this.capCount={black:0,white:0},this.turn=t.Color.BLACK,this.size=e,this.clear()}return e.prototype.isOnPosition=function(t,e){return t>=0&&e>=0&&t<this.size&&e<this.size},e.prototype.get=function(t,e){if(this.isOnPosition(t,e))return this.grid[t*this.size+e]},e.prototype.set=function(t,e,i){if(!this.isOnPosition(t,e))throw new TypeError("Attempt to set field outside of position.");return this.grid[t*this.size+e]=i,this},e.prototype.clear=function(){for(var e=0;e<this.size*this.size;e++)this.grid[e]=t.Color.EMPTY;return this},e.prototype.clone=function(){var t=new e(this.size);return t.grid=this.grid.slice(0),t.capCount.black=this.capCount.black,t.capCount.white=this.capCount.white,t.turn=this.turn,t},e.prototype.compare=function(t){if(t.size!==this.size)throw new TypeError("Positions of different sizes cannot be compared.");for(var e=[],i=0;i<this.size*this.size;i++)this.grid[i]!==t.grid[i]&&e.push({x:Math.floor(i/this.size),y:i%this.size,c:t.grid[i]});return e},e.prototype.applyMove=function(e,i,o,r,n){if(void 0===o&&(o=this.turn),void 0===r&&(r=!1),void 0===n&&(n=!1),!n&&this.get(e,i)!==t.Color.EMPTY)return!1;var s=this.get(e,i);this.set(e,i,o);var a=this.get(e,i-1)===-o&&this.captureIfNoLiberties(e,i-1),h=this.get(e+1,i)===-o&&this.captureIfNoLiberties(e+1,i),p=this.get(e,i+1)===-o&&this.captureIfNoLiberties(e,i+1),c=this.get(e-1,i)===-o&&this.captureIfNoLiberties(e-1,i);if(!(a||h||p||c)&&!this.hasLiberties(e,i)){if(!r)return this.set(e,i,s),!1;this.capture(e,i,o)}return this.turn=-o,!0},e.prototype.validatePosition=function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)this.captureIfNoLiberties(t-1,e);return this},e.prototype.hasLiberties=function(e,i,o,r){return void 0===o&&(o=function(t){for(var e=[],i=0;i<t;i++)e.push([]);return e}(this.size)),void 0===r&&(r=this.get(e,i)),!!this.isOnPosition(e,i)&&(this.get(e,i)===t.Color.EMPTY||!o[e][i]&&this.get(e,i)!==-r&&(o[e][i]=!0,this.hasLiberties(e,i-1,o,r)||this.hasLiberties(e,i+1,o,r)||this.hasLiberties(e-1,i,o,r)||this.hasLiberties(e+1,i,o,r)))},e.prototype.captureIfNoLiberties=function(t,e){return!this.hasLiberties(t,e)&&(this.capture(t,e),!0)},e.prototype.capture=function(e,i,o){void 0===o&&(o=this.get(e,i)),this.isOnPosition(e,i)&&o!==t.Color.EMPTY&&this.get(e,i)===o&&(this.set(e,i,t.Color.EMPTY),o===t.Color.BLACK?this.capCount.white=this.capCount.white+1:this.capCount.black=this.capCount.black+1,this.capture(e,i-1,o),this.capture(e,i+1,o),this.capture(e-1,i,o),this.capture(e+1,i,o))},e.prototype.toString=function(){for(var e="   ",i=0;i<this.size;i++)e+=i<9?i+" ":i;e+="\n";for(var o=0;o<this.size;o++)for(var r=0;r<this.size;r++){var n=this.grid[r*this.size+o];0===r&&(e+=(o<10?" "+o:o)+" "),n!==t.Color.EMPTY?e+=n===t.Color.BLACK?"\u25cf":"\u25cb":e+=0===o?0===r?"\u250c":r<this.size-1?"\u252c":"\u2510":o<this.size-1?0===r?"\u251c":r<this.size-1?"\u253c":"\u2524":0===r?"\u2514":r<this.size-1?"\u2534":"\u2518",r===this.size-1?o!==this.size-1&&(e+="\n"):e+="\u2500"}return e},e.prototype.toTwoDimensionalArray=function(){for(var t=[],e=0;e<this.size;e++){t[e]=[];for(var i=0;i<this.size;i++)t[e][i]=this.grid[e*this.size+i]}return t},e}(),rt=function(){function e(t,e){void 0===t&&(t=19),void 0===e&&(e=Q),this.size=t,this.rules=e,this.komi=e.komi,this.positionStack=[new ot(t)]}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionStack[this.positionStack.length-1]},set:function(t){this.positionStack[this.positionStack.length-1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"turn",{get:function(){return this.position.turn},set:function(t){this.position.turn=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"capCount",{get:function(){return this.position.capCount},enumerable:!0,configurable:!0}),e.prototype.play=function(t,e){var i=this.tryToPlay(t,e);return i&&this.pushPosition(i),i},e.prototype.tryToPlay=function(t,e){var i=this.position.clone();return!(!i.applyMove(t,e,i.turn,this.rules.allowSuicide,this.rules.allowRewrite)||this.hasPositionRepeated(i))&&i},e.prototype.hasPositionRepeated=function(e){var i;if(this.rules.repeating===t.Repeating.KO&&this.positionStack.length-2>=0)i=this.positionStack.length-2;else{if(this.rules.repeating!==t.Repeating.NONE)return!1;i=0}for(var o=this.positionStack.length-1;o>=i;o--)if(0===this.positionStack[o].compare(e).length)return!0;return!1},e.prototype.pass=function(t){void 0===t&&(t=this.turn);var e=this.position.clone();e.turn=-(t||this.turn),this.pushPosition(e)},e.prototype.isValid=function(t,e){return!!this.tryToPlay(t,e)},e.prototype.isOnBoard=function(t,e){return this.position.isOnPosition(t,e)},e.prototype.addStone=function(e,i,o){return!(!this.isOnBoard(e,i)||this.position.get(e,i)!==t.Color.EMPTY)&&(this.position.set(e,i,o),!0)},e.prototype.removeStone=function(e,i){return!(!this.isOnBoard(e,i)||this.position.get(e,i)===t.Color.EMPTY)&&(this.position.set(e,i,t.Color.EMPTY),!0)},e.prototype.setStone=function(t,e,i){return!!this.isOnBoard(t,e)&&(this.position.set(t,e,i),!0)},e.prototype.getStone=function(t,e){return this.position.get(t,e)},e.prototype.pushPosition=function(t){return this.positionStack.push(t)},e.prototype.popPosition=function(){return this.positionStack.length>1?this.positionStack.pop():null},e.prototype.clear=function(){this.positionStack=[this.positionStack[0]]},e}(),nt={read:function(t){return!0},write:function(t){return""}},st={read:function(t){return parseFloat(t)},write:function(t){return t.toString(10)}},at={read:function(t){return t},write:function(t){return t}},ht={read:function(e){return"w"===e||"W"===e?t.Color.WHITE:t.Color.BLACK},write:function(e){return e===t.Color.WHITE?"W":"B"}},pt={read:function(t){return t?{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97}:null},write:function(t){return t?String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97):""}},ct={read:function(t){return{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97,text:t.substr(3)}},write:function(t){return String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97)+":"+t.text}},lt={read:function(t){return t?[{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97},{x:t.charCodeAt(3)-97,y:t.charCodeAt(4)-97}]:null},write:function(t){return t?String.fromCharCode(t[0].x+97)+String.fromCharCode(t[0].y+97)+":"+(String.fromCharCode(t[1].x+97)+String.fromCharCode(t[1].y+97)):""}},ut={_default:{transformer:at,multiple:!1,notEmpty:!0}};ut.B=ut.W={transformer:pt,multiple:!1,notEmpty:!1},ut.KO={transformer:nt,multiple:!1,notEmpty:!1},ut.MN={transformer:st,multiple:!1,notEmpty:!0},ut.AB=ut.AW=ut.AE={transformer:pt,multiple:!0,notEmpty:!0},ut.PL={transformer:ht,multiple:!1,notEmpty:!0},ut.C=ut.N={transformer:at,multiple:!1,notEmpty:!0},ut.DM=ut.GB=ut.GW=ut.HO=ut.UC=ut.V={transformer:st,multiple:!1,notEmpty:!0},ut.BM=ut.TE={transformer:st,multiple:!1,notEmpty:!0},ut.DO=ut.IT={transformer:nt,multiple:!1,notEmpty:!1},ut.CR=ut.MA=ut.SL=ut.SQ=ut.TR={transformer:pt,multiple:!0,notEmpty:!0},ut.LB={transformer:ct,multiple:!0,notEmpty:!0},ut.AR=ut.LN={transformer:lt,multiple:!0,notEmpty:!0},ut.DD=ut.TB=ut.TW={transformer:pt,multiple:!0,notEmpty:!1},ut.AP=ut.CA={transformer:at,multiple:!1,notEmpty:!0},ut.FF=ut.GM=ut.ST=ut.SZ={transformer:st,multiple:!1,notEmpty:!0},ut.AN=ut.BR=ut.BT=ut.CP=ut.DT=ut.EV=ut.GN=ut.GC=ut.GN=ut.ON=ut.OT=ut.PB=ut.PC=ut.PW=ut.RE=ut.RO=ut.RU=ut.SO=ut.US=ut.WR=ut.WT={transformer:at,multiple:!1,notEmpty:!0},ut.TM=ut.HA=ut.KM={transformer:st,multiple:!1,notEmpty:!0},ut.BL=ut.WL=ut.OB=ut.OW={transformer:st,multiple:!1,notEmpty:!0},ut.PM={transformer:st,multiple:!1,notEmpty:!0},ut.VW={transformer:lt,multiple:!1,notEmpty:!0};var ft,dt=function t(e){var i=new yt;i.setSGFProperties(e.sequence[0]||{});for(var o=i,r=1;r<e.sequence.length;r++){var n=new yt;n.setSGFProperties(e.sequence[r]),o.appendChild(n),o=n}for(r=0;r<e.children.length;r++)o.appendChild(t(e.children[r]));return i},yt=function(){function t(){this.parent=null,this.children=[],this.properties={}}return Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;null!=t.parent;)t=t.parent;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerSGF",{get:function(){var t=";";for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t+=e+this.getSGFProperty(e));return 1===this.children.length?t+";"+this.children[0].innerSGF:this.children.length>1?this.children.reduce((function(t,e){return t+"(;"+e.innerSGF+")"}),t):t},enumerable:!0,configurable:!0}),t.prototype.getPath=function(){for(var t={depth:0,forks:[]},e=this;e.parent;)t.depth++,e.parent.children.length>1&&t.forks.unshift(e.parent.children.indexOf(e)),e=e.parent;return t},t.prototype.appendChild=function(e){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `appendChild` method, KNode was expected.");return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e)-1},t.prototype.contains=function(t){return this.children.indexOf(t)>=0||this.children.some((function(e){return e.contains(t)}))},t.prototype.insertBefore=function(e,i){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `insertBefore` method, KNode was expected.");return null==i?(this.appendChild(e),this):(e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(this.children.indexOf(i),0,e),this)},t.prototype.removeChild=function(t){return this.children.splice(this.children.indexOf(t),1),t.parent=null,this},t.prototype.replaceChild=function(e,i){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `replaceChild` method, KNode was expected.");return this.insertBefore(e,i),this.removeChild(i),this},t.prototype.getProperty=function(t){return this.properties[t]},t.prototype.setProperty=function(t,e){return null==e?delete this.properties[t]:this.properties[t]=e,this},t.prototype.getSGFProperty=function(t){if(null!=this.properties[t]){var e=ut[t]||ut._default;return Array.isArray(this.properties[t])?this.properties[t].map((function(t){return e.transformer.write(t).replace(/\]/g,"\\]")})):[e.transformer.write(this.properties[t]).replace(/\]/g,"\\]")]}return null},t.prototype.setSGFProperty=function(t,e){var i=ut[t]||ut._default;return null==e?(delete this.properties[t],this):(i.multiple?this.properties[t]=e.map((function(t){return i.transformer.read(t)})):this.properties[t]=i.transformer.read(e[0]),this)},t.prototype.setSGFProperties=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setSGFProperty(e,t[e]);return this},t.prototype.toSGF=function(){return"("+this.innerSGF+")"},t.fromJS=function(t){return dt(t)},t.fromSGF=function(e,i){void 0===i&&(i=0);var o=new c(e);return t.fromJS(o.parseCollection()[i])},t}();!function(t){t.BLACK_MOVE="B",t.EXECUTE_ILLEGAL="KO",t.MOVE_NUMBER="MN",t.WHITE_MOVE="W",t.ADD_BLACK="AB",t.CLEAR_FIELD="AE",t.ADD_WHITE="AW",t.SET_TURN="PL",t.COMMENT="C",t.EVEN_POSITION="DM",t.GOOD_FOR_BLACK="GB",t.GOOD_FOR_WHITE="GW",t.HOTSPOT="HO",t.NODE_NAME="N",t.UNCLEAR_POSITION="UC",t.NODE_VALUE="V",t.BAD_MOVE="BM",t.DOUBTFUL_MOVE="DM",t.INTERESTING_MOVE="IT",t.GOOD_MOVE="TE",t.ARROW="AR",t.CIRCLE="CR",t.DIM="DD",t.LABEL="LB",t.LINE="LN",t.X_MARK="MA",t.SELECTED="SL",t.SQUARE="SQ",t.TRIANGLE="TR",t.APPLICATION="AP",t.CHARSET="CA",t.SGF_VERSION="FF",t.GAME_TYPE="GM",t.VARIATIONS_STYLE="ST",t.BOARD_SIZE="SZ",t.ANNOTATOR="AN",t.BLACK_RANK="BR",t.BLACK_TEAM="BT",t.COPYRIGHT="CP",t.DATE="DT",t.EVENT="EV",t.GAME_NAME="GN",t.GAME_COMMENT="GC",t.OPENING_INFO="ON",t.OVER_TIME="OT",t.BLACK_NAME="BN",t.PLACE="PC",t.WHITE_NAME="PW",t.RESULT="RE",t.ROUND="RO",t.RULES="RU",t.SOURCE="SO",t.TIME_LIMITS="TM",t.AUTHOR="US",t.WHITE_RANK="WR",t.WHITE_TEAM="WT",t.BLACK_TIME_LEFT="BL",t.BLACK_STONES_LEFT="OB",t.WHITE_STONES_LEFT="OW",t.WHITE_TIME_LEFT="WL",t.FIGURE="FG",t.PRINT_MOVE_NUMBERS="PM",t.BOARD_SECTION="VW",t.HANDICAP="HA",t.KOMI="KM",t.BLACK_TERRITORY="TB",t.WHITE_TERRITORY="TW"}(ft||(ft={}));var gt=function(){function t(t){this.type=t}return t.prototype.register=function(t){this.registerEvent(t,"beforeInit"),this.registerEvent(t,"afterInit"),this.registerEvent(t,"beforeMove"),this.registerEvent(t,"afterMove"),this.registerEvent(t,"nextNode"),this.registerEvent(t,"previousNode"),this.registerEvent(t,"beforeNextNode"),this.registerEvent(t,"beforePreviousNode")},t.prototype.registerEvent=function(t,e){var i=this;this[e]&&t.on(e+":"+this.type,(function(o,r,n){n(i[e](o,t,r))}))},t}(),mt=function(t){function e(e,i){var o=t.call(this,e)||this;return o.color=i,o}return i(e,t),e.prototype.beforeMove=function(t,e){var i=this;t.forEach((function(t){e.game.setStone(t.x,t.y,i.color)}))},e}(gt),vt=function(t){function e(){return t.call(this,"PL")||this}return i(e,t),e.prototype.afterMove=function(t,e){e.game.turn=t},e}(gt),bt=function(t){function e(){return t.call(this,"SZ")||this}return i(e,t),e.prototype.beforeInit=function(t,e){e.params.size=t},e}(gt),xt=function(t){function e(){return t.call(this,"RU")||this}return i(e,t),e.prototype.beforeInit=function(t,e){it[t]&&(e.params.rules=it[t])},e}(gt),wt=function(e){function o(){return e.call(this,"HA")||this}return i(o,e),o.prototype.afterInit=function(e,i){e>1&&(i.game.turn=t.Color.WHITE)},o}(gt),St=[new bt,new xt,new wt,new mt("AW",t.Color.WHITE),new mt("AB",t.Color.BLACK),new mt("AE",t.Color.EMPTY),new vt],Ct=function(e){function o(){var t=e.call(this)||this;return t.registerPropertyHandlers(St),t}return i(o,e),o.prototype.loadKifu=function(t){this.rootNode=t,this.currentNode=t,this.propertiesData=new Map,this.params={size:19,rules:Q},this.executeRoot()},o.prototype.newGame=function(t,e){var i=new yt;if(t&&i.setProperty("SZ",t),e){var o=Object.keys(it).find((function(t){return it[t]===e}));o&&i.setProperty("RU",o)}this.loadKifu(i)},o.prototype.registerPropertyHandlers=function(t){var e=this;t.forEach((function(t){return t.register(e)}))},o.prototype.executeRoot=function(){this.emitNodeLifeCycleEvent("beforeInit"),this.game=new rt(this.params.size,this.params.rules),this.emitNodeLifeCycleEvent("afterInit"),this.executeMove(),this.emitNodeLifeCycleEvent("nextNode")},o.prototype.executeNext=function(t){this.emitNodeLifeCycleEvent("beforeNextNode"),this.game.pushPosition(this.game.position.clone()),this.currentNode=this.currentNode.children[t],this.executeMove(),this.emitNodeLifeCycleEvent("nextNode")},o.prototype.executePrevious=function(){this.emitNodeLifeCycleEvent("beforePreviousNode"),this.game.popPosition(),this.currentNode=this.currentNode.parent,this.emitNodeLifeCycleEvent("previousNode")},o.prototype.executeMove=function(){this.emitNodeLifeCycleEvent("beforeMove");var e=this.getProperty(ft.BLACK_MOVE),i=this.getProperty(ft.WHITE_MOVE);if(void 0!==e&&void 0!==i)throw new TypeError("Black (B) and white (W) properties must not be mixed within a node.");void 0!==e?e?this.game.position.applyMove(e.x,e.y,t.Color.BLACK,!0,!0):this.game.position.turn=t.Color.WHITE:void 0!==i&&(i?this.game.position.applyMove(i.x,i.y,t.Color.WHITE,!0,!0):this.game.position.turn=t.Color.BLACK),this.emitNodeLifeCycleEvent("afterMove")},o.prototype.emitNodeLifeCycleEvent=function(t){var e=this;this.emit(t),Object.keys(this.currentNode.properties).forEach((function(i){e.emit(t+":"+i,e.currentNode.properties[i],e.getPropertyData(i),e.setPropertyData.bind(e,i))}))},o.prototype.getPropertyData=function(t){var e=this.propertiesData.get(this.currentNode);return e?e[t]:void 0},o.prototype.setPropertyData=function(t,e){var i=this.propertiesData.get(this.currentNode);null==e?i&&delete i[t]:(i||(i={},this.propertiesData.set(this.currentNode,i)),i[t]=e)},o.prototype.getProperty=function(t){return this.currentNode.getProperty(t)},o.prototype.getRootProperty=function(t){return this.rootNode.getProperty(t)},o.prototype.getNextNodes=function(){return this.currentNode.children},o.prototype.next=function(t){if(void 0===t&&(t=0),this.currentNode.children.length){var e=void 0;if(e="number"===typeof t?t:this.currentNode.children.indexOf(t),this.currentNode.children[e])return this.executeNext(e),!0}return!1},o.prototype.previous=function(){return!!this.currentNode.parent&&(this.executePrevious(),!0)},o.prototype.first=function(){for(;this.previous(););},o.prototype.last=function(){for(;this.next(););},o.prototype.goTo=function(t){var e="number"===typeof t?{depth:t,forks:[]}:t;this.first();for(var i=0,o=0;i<e.depth;i++)this.currentNode.children.length>1?this.next(e.forks[o++]):this.next()},o.prototype.previousFork=function(){for(;this.previous();)if(this.currentNode.children.length>1)return},o}(X),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.nextNode=function(t,e,i){var o=this,r=[];return t.forEach((function(t){var i=new f(o.type,e.game.getStone(t.x,t.y));i.zIndex=10,e.board.addObjectAt(t.x,t.y,i),r.push(i)})),r},e.prototype.previousNode=function(t,e,i){return this.nextNode(t,e,i)},e.prototype.beforeNextNode=function(t,e,i){return i.forEach((function(t){e.board.removeObject(t)})),null},e.prototype.beforePreviousNode=function(t,e,i){return this.beforeNextNode(t,e,i)},e}(gt);function Nt(t,e){return e&&t.x===e.x&&t.y===e.y}var Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.nextNode=function(t,e,i){if(!function(t,e,i){for(var o=Object.keys(i),r=0;r<o.length;r++)if(o[r]!==t){var n=i[o[r]];if(Array.isArray(n)){for(var s=0;s<n.length;s++)if(Nt(e,n[s]))return!0}else if(Nt(e,n))return!0}return!1}(this.type,t,e.currentNode.properties)){var o=new f("B"===this.type?e.config.currentMoveBlackMark:e.config.currentMoveWhiteMark);return o.zIndex=10,e.board.addObjectAt(t.x,t.y,o),o}},e.prototype.previousNode=function(t,e,i){return this.nextNode(t,e,i)},e.prototype.beforeNextNode=function(t,e,i){return i&&e.board.removeObject(i),null},e.prototype.beforePreviousNode=function(t,e,i){return this.beforeNextNode(t,e,i)},e}(gt),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.nextNode=function(t,e,i){var o=this,r=[];return t.forEach((function(t){var i=new y(o.type,t[0],t[1]);i.zIndex=10,e.board.addObject(i),r.push(i)})),r},e.prototype.previousNode=function(t,e,i){return this.nextNode(t,e,i)},e.prototype.beforeNextNode=function(t,e,i){return i.forEach((function(t){e.board.removeObject(t)})),null},e.prototype.beforePreviousNode=function(t,e,i){return this.beforeNextNode(t,e,i)},e}(gt),Tt=function(t){function e(){return t.call(this,"LB")||this}return i(e,t),e.prototype.nextNode=function(t,e,i){var o=[];return t.forEach((function(t){var i=new d(t.text,e.game.getStone(t.x,t.y));i.zIndex=10,e.board.addObjectAt(t.x,t.y,i),o.push(i)})),o},e.prototype.previousNode=function(t,e,i){return this.nextNode(t,e,i)},e.prototype.beforeNextNode=function(t,e,i){return i.forEach((function(t){e.board.removeObject(t)})),null},e.prototype.beforePreviousNode=function(t,e,i){return this.beforeNextNode(t,e,i)},e}(gt),Mt=function(t){function e(){return t.call(this,"VW")||this}return i(e,t),e.prototype.nextNode=function(t,e,i){var o=e.board.getViewport();if(t){var r=Math.min(t[0].x,t[1].x),n=Math.min(t[0].y,t[1].y),s=Math.max(t[0].x,t[1].x),a=Math.max(t[0].y,t[1].y);e.board.setViewport({left:r,top:n,right:e.board.getSize()-s-1,bottom:e.board.getSize()-a-1})}else e.board.setViewport({top:0,right:0,bottom:0,left:0});return o},e.prototype.beforePreviousNode=function(t,e,i){return e.board.setViewport(i),null},e}(gt),zt={boardTheme:V.theme,currentMoveBlackMark:new A({color:"rgba(255,255,255,0.8)"}),currentMoveWhiteMark:new A({color:"rgba(0,0,0,0.8)"}),enableMouseWheel:!0,enableKeys:!0},At=[new Et("CR"),new Et("DD"),new Et("MA"),new Et("SL"),new Et("SQ"),new Et("TR"),new Tt,new Ot("AR"),new Ot("LN"),new Pt("B"),new Pt("W"),new Mt],kt={B:t.Color.BLACK,W:t.Color.WHITE},Lt=function(e){function o(t,i){void 0===i&&(i={});var o=e.call(this)||this;return o.element=t,o.config=Y(zt,i),o.init(),o}return i(o,e),o.prototype.init=function(){var t=this;this.board=new J(this.element,{theme:this.config.boardTheme}),this.stoneBoardsObjects=[],this.registerPropertyHandlers(At),this.on("afterMove",(function(){return t.updateStones()})),this.on("previousNode",(function(){return t.updateStones()})),this.element.tabIndex<0&&(this.element.tabIndex=1),document.addEventListener("mousewheel",this._mouseWheelEvent=function(e){if(document.activeElement===t.element&&t.config.enableMouseWheel)return e.deltaY>0?t.next():e.deltaY<0&&t.previous(),!1}),document.addEventListener("keydown",this._keyEvent=function(e){if(document.activeElement===t.element&&t.config.enableKeys)return"ArrowRight"===e.key?t.next():"ArrowLeft"===e.key&&t.previous(),!1})},o.prototype.destroy=function(){document.removeEventListener("mousewheel",this._mouseWheelEvent),this._mouseWheelEvent=null,document.removeEventListener("keydown",this._keyEvent)},o.prototype.updateStones=function(){var e=this;this.stoneBoardsObjects=this.stoneBoardsObjects.filter((function(t){return e.game.getStone(t.x,t.y)===kt[t.type]||(e.board.removeObject(t),!1)}));for(var i=this.game.position,o=function(e){for(var o=function(o){var n=i.get(e,o);if(n&&!r.stoneBoardsObjects.some((function(t){return t.x===e&&t.y===o&&n===kt[t.type]}))){var s=new u(n===t.Color.B?"B":"W");r.board.addObjectAt(e,o,s),r.stoneBoardsObjects.push(s)}},n=0;n<i.size;n++)o(n)},r=this,n=0;n<i.size;n++)o(n)},o}(Ct),It=function(e){function o(t){void 0===t&&(t=new yt);var i=e.call(this)||this;return i.rootNode=t,i.currentNode=t,i.executeRootNode(),i.executeNode(),i}return i(o,e),o.prototype.executeRootNode=function(){var e=this.getRootProperty(ft.BOARD_SIZE)||19,i=it[this.getRootProperty(ft.RULES)]||Q,o=this.getRootProperty(ft.HANDICAP)||0;this.game=new rt(e,i),o>1&&(this.game.turn=t.Color.WHITE)},o.prototype.executeNode=function(){var e=this,i=this.getProperty(ft.ADD_BLACK)||[],o=this.getProperty(ft.ADD_WHITE)||[],r=this.getProperty(ft.CLEAR_FIELD)||[];i.forEach((function(i){return e.game.setStone(i.x,i.y,t.Color.BLACK)})),o.forEach((function(i){return e.game.setStone(i.x,i.y,t.Color.WHITE)})),r.forEach((function(i){return e.game.setStone(i.x,i.y,t.Color.EMPTY)}));var n=this.getProperty(ft.BLACK_MOVE),s=this.getProperty(ft.WHITE_MOVE);if(void 0!==n&&void 0!==s)throw"Some error";void 0!==n?n?this.game.position.applyMove(n.x,n.y,t.Color.BLACK,!0,!0):this.game.position.turn=t.Color.WHITE:void 0!==s&&(s?this.game.position.applyMove(s.x,s.y,t.Color.WHITE,!0,!0):this.game.position.turn=t.Color.BLACK);var a=this.getProperty(ft.SET_TURN);a&&(this.game.turn=a)},o.prototype.resetNode=function(){this.currentNode.parent?(this.game.popPosition(),this.game.pushPosition(this.game.position.clone()),this.executeNode()):(this.executeRootNode(),this.executeNode())},o.prototype.getProperty=function(t){return this.currentNode.getProperty(t)},o.prototype.getRootProperty=function(t){return this.rootNode.getProperty(t)},o.prototype.getNextNodes=function(){return this.currentNode.children},o.prototype.next=function(t){if(void 0===t&&(t=0),this.currentNode.children.length){var e=void 0;if(e="number"===typeof t?t:this.currentNode.children.indexOf(t),this.currentNode.children[e])return this.game.pushPosition(this.game.position.clone()),this.currentNode=this.currentNode.children[e],this.executeNode(),!0}return!1},o.prototype.previous=function(){return!!this.currentNode.parent&&(this.game.popPosition(),this.currentNode=this.currentNode.parent,!0)},o.prototype.first=function(){this.game.clear(),this.currentNode=this.rootNode},o.prototype.last=function(){for(;this.next(););},o.prototype.goTo=function(t){var e="number"===typeof t?{depth:t,forks:[]}:t;this.first();for(var i=0,o=0;i<e.depth;i++)this.currentNode.children.length>1?this.next(e.forks[o++]):this.next()},o.prototype.previousFork=function(){for(;this.previous();)if(this.currentNode.children.length>1)return},o}(X);t.BoardLabelObject=d,t.BoardLineObject=y,t.BoardMarkupObject=f,t.BoardObject=l,t.CHINESE_RULES=$,t.CanvasBoard=J,t.FieldObject=u,t.Game=rt,t.ING_RULES=tt,t.JAPANESE_RULES=Q,t.KifuNode=yt,t.KifuReader=It,t.NO_RULES=et,t.PlainPlayer=Lt,t.PlayerBase=Ct,t.Position=ot,t.SGFParser=c,t.SGFSyntaxError=r,t.defaultBoardConfig=V,t.drawHandlers=j,t.goRules=it,t.propertyValueTypes=ut,t.themes=F,Object.defineProperty(t,"__esModule",{value:!0})}(e)}}]);
//# sourceMappingURL=11.d49b5d17.chunk.js.map