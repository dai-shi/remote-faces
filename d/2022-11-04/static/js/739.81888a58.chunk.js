/*! For license information please see 739.81888a58.chunk.js.LICENSE.txt */
(self.webpackChunkremote_faces_web=self.webpackChunkremote_faces_web||[]).push([[739],{35739:function(t,e){!function(t){"use strict";var e;(e=t.Color||(t.Color={}))[e.BLACK=1]="BLACK",e[e.B=1]="B",e[e.WHITE=-1]="WHITE",e[e.W=-1]="W",e[e.EMPTY=0]="EMPTY",e[e.E=0]="E";var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)};function i(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){return o=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};function n(t){var e="function"===typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,o,n=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}var l=function(t){function e(e,r){var i=this.constructor,o=t.call(this,e)||this;return o.__proto__=i.prototype,o.name=o.name="SGFSyntaxError",o.message=e||"There was an unspecified syntax error in the SGF",r&&(o.message+=" on line "+r.lineNo+", char "+r.charNo+":\n",o.message+="\t"+r.sgfString.split("\n")[r.lineNo-1]+"\n",o.message+="\t"+Array(r.charNo+1).join(" ")+"^"),o}return i(e,t),e}(Error),p="A".charCodeAt(0),h="Z".charCodeAt(0),c=" ".charCodeAt(0);function u(t){if(!t)return!1;var e=t.charCodeAt(0);return e>=p&&e<=h}var d=function(){function t(t){this.position=0,this.lineNo=1,this.charNo=0,this.sgfString=t}return t.prototype.currentChar=function(){for(;this.sgfString.charCodeAt(this.position)<=c;)this.nextChar();return this.sgfString[this.position]},t.prototype.nextChar=function(){return"\n"===this.sgfString[this.position]?(this.charNo=0,this.lineNo++):this.charNo++,this.position++,this.sgfString[this.position]},t.prototype.processChar=function(t){if(this.currentChar()!==t)throw new l("Unexpected character "+this.currentChar()+". Character "+t+" was expected.",this);return this.nextChar()},t.prototype.parsePropertyValue=function(t){if(!t||"["===this.currentChar()){for(var e="",r=this.processChar("[");"]"!==r;){if(!r)throw new l("End of SGF inside of property",this);if("\\"===r){if(!(r=this.nextChar()))throw new l("End of SGF inside of property",this);if("\n"===r)continue}e+=r,r=this.nextChar()}return this.processChar("]"),e}},t.prototype.parsePropertyIdent=function(){var t="",e=this.currentChar();if(!u(e))throw new l("Property identifier must consists from upper case letters.",this);for(t+=e;(e=this.nextChar())&&u(e);)t+=e;return t},t.prototype.parsePropertyValues=function(){var t=[],e=this.parsePropertyValue();for(e&&t.push(e);e=this.parsePropertyValue(!0);)t.push(e);return t},t.prototype.parseProperty=function(){if(u(this.currentChar()))return[this.parsePropertyIdent(),this.parsePropertyValues()]},t.prototype.parseNode=function(){this.processChar(";");for(var t,e={};t=this.parseProperty();)e[t[0]]=t[1];return e},t.prototype.parseSequence=function(){var t=[];for(t.push(this.parseNode());";"===this.currentChar();)t.push(this.parseNode());return t},t.prototype.parseGameTree=function(){this.processChar("(");var t=this.parseSequence(),e=[];return"("===this.currentChar()&&(e=this.parseCollection()),this.processChar(")"),{sequence:t,children:e}},t.prototype.parseCollection=function(){var t=[];for(t.push(this.parseGameTree());"("===this.currentChar();)t.push(this.parseGameTree());return t},t}(),f={read:function(t){return!0},write:function(t){return""}},m={read:function(t){return parseFloat(t)},write:function(t){return t.toString(10)}},y={read:function(t){return t},write:function(t){return t}},b={read:function(e){return"w"===e||"W"===e?t.Color.WHITE:t.Color.BLACK},write:function(e){return e===t.Color.WHITE?"W":"B"}},g={read:function(t){return t?{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97}:null},write:function(t){return t?String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97):""}},v={read:function(t){return{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97,text:t.substr(3)}},write:function(t){return String.fromCharCode(t.x+97)+String.fromCharCode(t.y+97)+":"+t.text}},C={read:function(t){return t?[{x:t.charCodeAt(0)-97,y:t.charCodeAt(1)-97},{x:t.charCodeAt(3)-97,y:t.charCodeAt(4)-97}]:null},write:function(t){return t?String.fromCharCode(t[0].x+97)+String.fromCharCode(t[0].y+97)+":"+(String.fromCharCode(t[1].x+97)+String.fromCharCode(t[1].y+97)):""}},E={_default:{transformer:y,multiple:!1,notEmpty:!0}};E.B=E.W={transformer:g,multiple:!1,notEmpty:!1},E.KO={transformer:f,multiple:!1,notEmpty:!1},E.MN={transformer:m,multiple:!1,notEmpty:!0},E.AB=E.AW=E.AE={transformer:g,multiple:!0,notEmpty:!0},E.PL={transformer:b,multiple:!1,notEmpty:!0},E.C=E.N={transformer:y,multiple:!1,notEmpty:!0},E.DM=E.GB=E.GW=E.HO=E.UC=E.V={transformer:m,multiple:!1,notEmpty:!0},E.BM=E.TE={transformer:m,multiple:!1,notEmpty:!0},E.DO=E.IT={transformer:f,multiple:!1,notEmpty:!1},E.CR=E.MA=E.SL=E.SQ=E.TR={transformer:g,multiple:!0,notEmpty:!0},E.LB={transformer:v,multiple:!0,notEmpty:!0},E.AR=E.LN={transformer:C,multiple:!0,notEmpty:!0},E.DD=E.TB=E.TW={transformer:g,multiple:!0,notEmpty:!1},E.AP=E.CA={transformer:y,multiple:!1,notEmpty:!0},E.FF=E.GM=E.ST=E.SZ={transformer:m,multiple:!1,notEmpty:!0},E.AN=E.BR=E.BT=E.CP=E.DT=E.EV=E.GN=E.GC=E.GN=E.ON=E.OT=E.PB=E.PC=E.PW=E.RE=E.RO=E.RU=E.SO=E.US=E.WR=E.WT={transformer:y,multiple:!1,notEmpty:!0},E.TM=E.HA=E.KM={transformer:m,multiple:!1,notEmpty:!0},E.BL=E.WL=E.OB=E.OW={transformer:m,multiple:!1,notEmpty:!0},E.PM={transformer:m,multiple:!1,notEmpty:!0},E.VW={transformer:C,multiple:!1,notEmpty:!0};var A,x=function(t,e){e.setSGFProperties(t.sequence[0]||{});for(var r=e,i=1;i<t.sequence.length;i++){var o=new S;o.setSGFProperties(t.sequence[i]),r.appendChild(o),r=o}for(i=0;i<t.children.length;i++)r.appendChild(x(t.children[i],new S));return e},N=["\\\\","\\]"],w=function(t){return N.reduce((function(t,e){return t.replace(new RegExp(e,"g"),e)}),t)},S=function(){function t(){this.parent=null,this.children=[],this.properties={}}return Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;null!=t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerSGF",{get:function(){var t=";";for(var e in this.properties)this.properties.hasOwnProperty(e)&&(t+=e+"["+this.getSGFProperty(e).map(w).join("][")+"]");return 1===this.children.length?""+t+this.children[0].innerSGF:this.children.length>1?this.children.reduce((function(t,e){return t+"("+e.innerSGF+")"}),t):t},set:function(e){this.clean();var r=e;"("!==r[0]&&(";"!==r[0]&&(r=";"+r),r="("+r+")"),t.fromSGF(r,0,this)},enumerable:!1,configurable:!0}),t.prototype.getPath=function(){for(var t={depth:0,forks:[]},e=this;e.parent;)t.depth++,e.parent.children.length>1&&t.forks.unshift(e.parent.children.indexOf(e)),e=e.parent;return t},t.prototype.appendChild=function(e){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `appendChild` method, KNode was expected.");return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e)-1},t.prototype.contains=function(t){return this.children.indexOf(t)>=0||this.children.some((function(e){return e.contains(t)}))},t.prototype.insertBefore=function(e,r){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `insertBefore` method, KNode was expected.");return null==r?(this.appendChild(e),this):(e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(this.children.indexOf(r),0,e),this)},t.prototype.removeChild=function(t){return this.children.splice(this.children.indexOf(t),1),t.parent=null,this},t.prototype.replaceChild=function(e,r){if(null==e||!(e instanceof t)||e===this)throw new Error("Invalid argument passed to `replaceChild` method, KNode was expected.");return this.insertBefore(e,r),this.removeChild(r),this},t.prototype.clean=function(){for(var t=this.children.length-1;t>=0;t--)this.removeChild(this.children[t]);this.properties={}},t.prototype.getProperty=function(t){return this.properties[t]},t.prototype.setProperty=function(t,e){return void 0===e?delete this.properties[t]:this.properties[t]=e,this},t.prototype.removeProperty=function(t){this.setProperty(t)},t.prototype.forEachProperty=function(t){var e=this;Object.keys(this.properties).forEach((function(r){return t(r,e.properties[r])}))},t.prototype.getSGFProperty=function(t){if(void 0!==this.properties[t]){var e=E[t]||E._default;return e.multiple?this.properties[t].map((function(t){return e.transformer.write(t)})):[e.transformer.write(this.properties[t])]}return null},t.prototype.setSGFProperty=function(t,e){var r=E[t]||E._default;return void 0===e?(delete this.properties[t],this):(r.multiple?this.properties[t]=e.map((function(t){return r.transformer.read(t)})):this.properties[t]=r.transformer.read(e[0]),this)},t.prototype.setSGFProperties=function(t){for(var e in t)t.hasOwnProperty(e)&&this.setSGFProperty(e,t[e]);return this},t.prototype.toSGF=function(){return"("+this.innerSGF+")"},t.prototype.cloneNode=function(e){var r=new t,i=JSON.parse(JSON.stringify(this.properties));return r.properties=i,this.children.forEach((function(t){r.appendChild(t.cloneNode())})),e&&this.parent&&this.parent.appendChild(r),r},t.fromJS=function(e,r){return void 0===r&&(r=new t),x(e,r)},t.fromSGF=function(e,r,i){void 0===r&&(r=0),void 0===i&&(i=new t);var o=new d(e);return t.fromJS(o.parseCollection()[r],i)},t}();(A=t.Repeating||(t.Repeating={})).KO="KO",A.ALL="ALL",A.NONE="NONE";var O={repeating:t.Repeating.KO,allowRewrite:!1,allowSuicide:!1,komi:6.5},_={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!1,komi:7.5},M={repeating:t.Repeating.NONE,allowRewrite:!1,allowSuicide:!0,komi:7.5},k={repeating:t.Repeating.ALL,allowRewrite:!0,allowSuicide:!0,komi:0},T={Japanese:O,GOE:M,NZ:M,AGA:_,Chinese:_};function P(t){for(var e=[],r=0;r<t;r++)e.push([]);return e}var L=function(){function e(e){void 0===e&&(e=19),this.grid=[],this.capCount={black:0,white:0},this.turn=t.Color.BLACK,this.size=e,this.clear()}return e.prototype.isOnPosition=function(t,e){return t>=0&&e>=0&&t<this.size&&e<this.size},e.prototype.get=function(t,e){if(this.isOnPosition(t,e))return this.grid[t*this.size+e]},e.prototype.set=function(t,e,r){if(!this.isOnPosition(t,e))throw new TypeError("Attempt to set field outside of position.");return this.grid[t*this.size+e]=r,this},e.prototype.clear=function(){for(var e=0;e<this.size*this.size;e++)this.grid[e]=t.Color.EMPTY;return this},e.prototype.clone=function(){var t=new e(this.size);return t.grid=this.grid.slice(0),t.capCount.black=this.capCount.black,t.capCount.white=this.capCount.white,t.turn=this.turn,t},e.prototype.compare=function(t){if(t.size!==this.size)throw new TypeError("Positions of different sizes cannot be compared.");for(var e=[],r=0;r<this.size*this.size;r++)this.grid[r]!==t.grid[r]&&e.push({x:Math.floor(r/this.size),y:r%this.size,c:t.grid[r]});return e},e.prototype.applyMove=function(e,r,i,o,n){if(void 0===i&&(i=this.turn),void 0===o&&(o=!1),void 0===n&&(n=!1),!n&&this.get(e,r)!==t.Color.EMPTY)return!1;var s=this.get(e,r);this.set(e,r,i);var a=this.get(e,r-1)===-i&&this.captureIfNoLiberties(e,r-1),l=this.get(e+1,r)===-i&&this.captureIfNoLiberties(e+1,r),p=this.get(e,r+1)===-i&&this.captureIfNoLiberties(e,r+1),h=this.get(e-1,r)===-i&&this.captureIfNoLiberties(e-1,r);if(!(a||l||p||h)&&!this.hasLiberties(e,r)){if(!o)return this.set(e,r,s),!1;this.capture(e,r,i)}return this.turn=-i,!0},e.prototype.validatePosition=function(){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++)this.captureIfNoLiberties(t-1,e);return this},e.prototype.hasLiberties=function(e,r,i,o){return void 0===i&&(i=P(this.size)),void 0===o&&(o=this.get(e,r)),!!this.isOnPosition(e,r)&&(this.get(e,r)===t.Color.EMPTY||!i[e][r]&&this.get(e,r)!==-o&&(i[e][r]=!0,this.hasLiberties(e,r-1,i,o)||this.hasLiberties(e,r+1,i,o)||this.hasLiberties(e-1,r,i,o)||this.hasLiberties(e+1,r,i,o)))},e.prototype.captureIfNoLiberties=function(t,e){return!this.hasLiberties(t,e)&&(this.capture(t,e),!0)},e.prototype.capture=function(e,r,i){void 0===i&&(i=this.get(e,r)),this.isOnPosition(e,r)&&i!==t.Color.EMPTY&&this.get(e,r)===i&&(this.set(e,r,t.Color.EMPTY),i===t.Color.BLACK?this.capCount.white=this.capCount.white+1:this.capCount.black=this.capCount.black+1,this.capture(e,r-1,i),this.capture(e,r+1,i),this.capture(e-1,r,i),this.capture(e+1,r,i))},e.prototype.toString=function(){for(var e="\u250c",r="\u252c",i="\u2510",o="\u251c",n="\u253c",s="\u2524",a="\u2514",l="\u2534",p="\u2518",h="\u25cf",c="\u25cb",u="\u2500",d="   ",f=0;f<this.size;f++)d+=f<9?f+" ":f;d+="\n";for(var m=0;m<this.size;m++)for(var y=0;y<this.size;y++){var b=this.grid[y*this.size+m];0===y&&(d+=(m<10?" "+m:m)+" "),b!==t.Color.EMPTY?d+=b===t.Color.BLACK?h:c:d+=0===m?0===y?e:y<this.size-1?r:i:m<this.size-1?0===y?o:y<this.size-1?n:s:0===y?a:y<this.size-1?l:p,y===this.size-1?m!==this.size-1&&(d+="\n"):d+=u}return d},e.prototype.toTwoDimensionalArray=function(){for(var t=[],e=0;e<this.size;e++){t[e]=[];for(var r=0;r<this.size;r++)t[e][r]=this.grid[e*this.size+r]}return t},e}(),B=function(){function e(t,e){void 0===t&&(t=19),void 0===e&&(e=O),this.size=t,this.rules=e,this.komi=e.komi,this.positionStack=[new L(t)]}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionStack[this.positionStack.length-1]},set:function(t){this.positionStack[this.positionStack.length-1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"turn",{get:function(){return this.position.turn},set:function(t){this.position.turn=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"capCount",{get:function(){return this.position.capCount},enumerable:!1,configurable:!0}),e.prototype.play=function(t,e){var r=this.tryToPlay(t,e);return r&&this.pushPosition(r),r},e.prototype.tryToPlay=function(t,e){var r=this.position.clone();return!(!r.applyMove(t,e,r.turn,this.rules.allowSuicide,this.rules.allowRewrite)||this.hasPositionRepeated(r))&&r},e.prototype.hasPositionRepeated=function(e){var r;if(this.rules.repeating===t.Repeating.KO&&this.positionStack.length-2>=0)r=this.positionStack.length-2;else{if(this.rules.repeating!==t.Repeating.NONE)return!1;r=0}for(var i=this.positionStack.length-1;i>=r;i--)if(0===this.positionStack[i].compare(e).length)return!0;return!1},e.prototype.pass=function(t){void 0===t&&(t=this.turn);var e=this.position.clone();e.turn=-(t||this.turn),this.pushPosition(e)},e.prototype.isValid=function(t,e){return!!this.tryToPlay(t,e)},e.prototype.isOnBoard=function(t,e){return this.position.isOnPosition(t,e)},e.prototype.addStone=function(e,r,i){return!(!this.isOnBoard(e,r)||this.position.get(e,r)!==t.Color.EMPTY)&&(this.position.set(e,r,i),!0)},e.prototype.removeStone=function(e,r){return!(!this.isOnBoard(e,r)||this.position.get(e,r)===t.Color.EMPTY)&&(this.position.set(e,r,t.Color.EMPTY),!0)},e.prototype.setStone=function(t,e,r){return!!this.isOnBoard(t,e)&&(this.position.set(t,e,r),!0)},e.prototype.getStone=function(t,e){return this.position.get(t,e)},e.prototype.pushPosition=function(t){return this.positionStack.push(t)},e.prototype.popPosition=function(){return this.positionStack.length>1?this.positionStack.pop():null},e.prototype.clear=function(){this.positionStack=[this.positionStack[0]]},e}(),R=function(){function t(t){this.zIndex=0,this.opacity=1,this.type=t}return t}(),I=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,e)||this;return o.scaleX=1,o.scaleY=1,o.rotate=0,o.x=r,o.y=i,o}return i(e,t),e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setScale=function(t){this.scaleX=t,this.scaleY=t},e}(R),G=function(e){function r(r,i,o,n){void 0===i&&(i=0),void 0===o&&(o=0),void 0===n&&(n=t.Color.E);var s=e.call(this,r,i,o)||this;return s.variation=n,s}return i(r,e),r}(I),j=function(t){function e(e,r,i,o){void 0===r&&(r=0),void 0===i&&(i=0);var n=t.call(this,"LB",r,i,o)||this;return n.text=e,n}return i(e,t),e}(G),W=function(t){function e(e,r,i){var o=t.call(this,e)||this;return o.start=r,o.end=i,o}return i(e,t),e}(R),z=function(){function t(){this._events={}}return t.prototype.on=function(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)},t.prototype.off=function(t,e){this._events[t]&&(null==e&&(this._events[t]=[]),this._events[t]=this._events[t].filter((function(t){return t!==e})))},t.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._events[t]&&this._events[t].forEach((function(t){return t.apply(void 0,a(e))}))},t}();function V(t,e){var r={},i=Object.keys(t);return i.forEach((function(i){var o=e[i],n=t[i];null==o||o.constructor!==Object||Array.isArray(o)||null==n?r[i]=void 0!==o?o:n:r[i]=V(n,o)})),Object.keys(e).forEach((function(t){-1===i.indexOf(t)&&(r[t]=e[t])})),r}var H={stoneSize:.47,marginSize:.25,font:"calibri",backgroundColor:"#CEB053",backgroundImage:"",markupBlackColor:"rgba(255,255,255,0.9)",markupWhiteColor:"rgba(0,0,0,0.7)",markupNoneColor:"rgba(0,0,0,0.7)",markupLineWidth:.05,shadowColor:"rgba(62,32,32,0.5)",shadowTransparentColor:"rgba(62,32,32,0)",shadowBlur:.25,shadowOffsetX:.07,shadowOffsetY:.13,grid:{linesWidth:.03,linesColor:"#654525",starColor:"#531",starSize:.07},coordinates:{color:"#531",bold:!1,labelsX:"ABCDEFGHJKLMNOPQRSTUVWXYZ",labelsY:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]},starPoints:{5:[{x:2,y:2}],7:[{x:3,y:3}],8:[{x:2,y:2},{x:5,y:2},{x:2,y:5},{x:5,y:5}],9:[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}],10:[{x:2,y:2},{x:7,y:2},{x:2,y:7},{x:7,y:7}],11:[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}],12:[{x:3,y:3},{x:8,y:3},{x:3,y:8},{x:8,y:8}],13:[{x:3,y:3},{x:9,y:3},{x:6,y:6},{x:3,y:9},{x:9,y:9}],14:[{x:3,y:3},{x:10,y:3},{x:3,y:10},{x:10,y:10}],15:[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}],16:[{x:3,y:3},{x:12,y:3},{x:3,y:12},{x:12,y:12}],17:[{x:3,y:3},{x:8,y:3},{x:13,y:3},{x:3,y:8},{x:8,y:8},{x:13,y:8},{x:3,y:13},{x:8,y:13},{x:13,y:13}],18:[{x:3,y:3},{x:14,y:3},{x:3,y:14},{x:14,y:14}],19:[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],20:[{x:3,y:3},{x:16,y:3},{x:3,y:16},{x:16,y:16}],21:[{x:3,y:3},{x:10,y:3},{x:17,y:3},{x:3,y:10},{x:10,y:10},{x:17,y:10},{x:3,y:17},{x:10,y:17},{x:17,y:17}]}},D={size:19,width:0,height:0,viewport:{top:0,right:0,bottom:0,left:0},coordinates:!1,theme:H},F=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this)||this;return i.objects=[],i.element=e,i.config=V(D,r),i}return i(e,t),e.prototype.resize=function(){},e.prototype.redraw=function(){},e.prototype.addObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.addObject(t[e]);else this.hasObject(t)||this.objects.push(t)},e.prototype.updateObject=function(t){},e.prototype.removeObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.removeObject(t[e]);else{var r=this.objects.indexOf(t);-1!==r&&this.objects.splice(r,1)}},e.prototype.removeObjectsAt=function(t,e){var r=this;this.objects.forEach((function(i){i instanceof I&&i.x===t&&i.y===e&&r.removeObject(i)}))},e.prototype.removeAllObjects=function(){this.objects=[]},e.prototype.hasObject=function(t){return this.objects.indexOf(t)>=0},e.prototype.setWidth=function(t){this.config.width=t,this.config.height=0,this.resize()},e.prototype.setHeight=function(t){this.config.width=0,this.config.height=t,this.resize()},e.prototype.setDimensions=function(t,e){this.config.width=t,this.config.height=e,this.resize()},e.prototype.getViewport=function(){return this.config.viewport},e.prototype.setViewport=function(t){this.config.viewport=t},e.prototype.getSize=function(){return this.config.size},e.prototype.setSize=function(t){void 0===t&&(t=19),this.config.size=t},e.prototype.getCoordinates=function(){return this.config.coordinates},e.prototype.setCoordinates=function(t){this.config.coordinates=t},e}(z),K="http://www.w3.org/2000/svg",Y="objects",U="gridMask",X="shadows",q=function(){function t(t){void 0===t&&(t={}),this.params=t}return t.prototype.createElement=function(){var t;return(t={})[Y]=this.createSVGElements(),t[U]=this.createSVGElements(),t},t.prototype.createSVGElements=function(){var t=document.createElementNS(K,"g"),e=document.createElementNS(K,"circle"),r=document.createElementNS(K,"line"),i=document.createElementNS(K,"polygon");return t.appendChild(e),t.appendChild(r),t.appendChild(i),t},t.prototype.updateElement=function(t,e,r){t[Y].setAttribute("stroke",this.params.color||r.theme.markupNoneColor),t[Y].setAttribute("fill",this.params.color||r.theme.markupNoneColor),t[Y].setAttribute("stroke-width",this.params.lineWidth||r.theme.markupLineWidth),this.updateSVGElements(t[Y],e),t[U].setAttribute("stroke","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[U].setAttribute("fill","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[U].setAttribute("stroke-width",3*(this.params.lineWidth||r.theme.markupLineWidth)),this.updateSVGElements(t[U],e)},t.prototype.updateSVGElements=function(t,e){var r=t.children[0],i=t.children[1],o=t.children[2],n=e.start.x,s=e.start.y,a=e.end.x,l=e.end.y,p=Math.sqrt((a-n)*(a-n)+(l-s)*(l-s)),h=function(t){return n+t*(a-n)},c=function(t){return s+t*(l-s)},u=1/p/2.5,d=h(1-u),f=c(1-u),m=function(t){return d+t*(l-s)},y=function(t){return f+t*(n-a)},b=.1;r.setAttribute("cx",n),r.setAttribute("cy",s),r.setAttribute("r",b),i.setAttribute("x1",h(1/p*b)),i.setAttribute("y1",c(1/p*b)),i.setAttribute("x2",d),i.setAttribute("y2",f),o.setAttribute("points","\n      "+m(-u/1.75)+","+y(-u/1.75)+"\n      "+m(u/1.75)+","+y(u/1.75)+"\n      "+a+","+l+"\n    ")},t}(),J=function(){function t(){}return t.prototype.updateElement=function(t,e,r){var i="translate("+e.x+", "+e.y+")",o="scale("+e.scaleX+", "+e.scaleY+")",n="rotate("+e.rotate+")";Object.keys(t).forEach((function(r){t[r].setAttribute("transform",i+" "+o+" "+n),t[r].setAttribute("opacity",e.opacity)}))},t}(),Z=function(e){function r(t){void 0===t&&(t={});var r=e.call(this)||this;return r.params=t,r}return i(r,e),r.prototype.updateElement=function(r,i,o){e.prototype.updateElement.call(this,r,i,o),i.variation===t.Color.B?(r[Y].setAttribute("stroke",o.theme.markupBlackColor),r[Y].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")):i.variation===t.Color.W?(r[Y].setAttribute("stroke",o.theme.markupWhiteColor),r[Y].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")):(r[Y].setAttribute("stroke",this.params.color||o.theme.markupNoneColor),r[Y].setAttribute("fill",this.params.fillColor||"rgba(0,0,0,0)")),r[Y].setAttribute("stroke-width",this.params.lineWidth||o.theme.markupLineWidth)},r}(J),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(K,"circle");r.setAttribute("cx","0"),r.setAttribute("cy","0"),r.setAttribute("r","0.25");var i=document.createElementNS(K,"circle");return i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","0.35"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[Y]=r,e[U]=i,e},e}(Z),$=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r}return i(e,t),e.prototype.createElement=function(){var t=document.createElementNS(K,"rect");return t.setAttribute("x","-0.5"),t.setAttribute("y","-0.5"),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill",this.params.color),t},e}(J),tt=function(t){function e(e){var r=t.call(this)||this;return r.params=e,r}return i(e,t),e.prototype.createElement=function(){var t=document.createElementNS(K,"circle");return t.setAttribute("cx","0"),t.setAttribute("cy","0"),t.setAttribute("r","0.15"),t.setAttribute("fill",this.params.color),t},e}(J);function et(t){return t+"-"+Math.floor(1e9*Math.random()).toString(36)}var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(t,e){return null},e.prototype.createShadow=function(t,e){var r=t.theme.stoneSize;if(!this.shadowFilterElement){var i=document.createElementNS(K,"radialGradient"),o=t.theme.shadowBlur,n=Math.max(r-r*o,1e-5),s=r+1/7*r*o;i.setAttribute("id",et("shadowFilter")),i.setAttribute("fr",String(n)),i.setAttribute("r",String(s)),i.innerHTML='\n        <stop offset="0%" stop-color="'+t.theme.shadowColor+'" />\n        <stop offset="100%" stop-color="'+t.theme.shadowTransparentColor+'" />\n      ',e(i),this.shadowFilterElement=i}var a=document.createElementNS(K,"circle");return a.setAttribute("cx",String(t.theme.shadowOffsetX)),a.setAttribute("cy",String(t.theme.shadowOffsetY)),a.setAttribute("r",String(r)),a.setAttribute("fill","url(#"+this.shadowFilterElement.id+")"),a},e}(J),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement){var o=document.createElementNS(K,"filter");o.setAttribute("id",et("filter")),o.setAttribute("x","-300%"),o.setAttribute("y","-300%"),o.setAttribute("width","600%"),o.setAttribute("height","600%");var n=document.createElementNS(K,"feGaussianBlur");n.setAttribute("in","SourceGraphic"),n.setAttribute("stdDeviation",.3*e.theme.stoneSize),o.appendChild(n),this.filterElement=o,r(o)}var s=document.createElementNS(K,"g"),a=document.createElementNS(K,"circle");a.setAttribute("cx","0"),a.setAttribute("cy","0"),a.setAttribute("fill","#000"),a.setAttribute("r",e.theme.stoneSize),s.appendChild(a);var l=document.createElementNS(K,"circle");l.setAttribute("cx",-.4*e.theme.stoneSize),l.setAttribute("cy",-.4*e.theme.stoneSize),l.setAttribute("r",.25*e.theme.stoneSize),l.setAttribute("fill","#fff"),l.setAttribute("filter","url(#"+this.filterElement.id+")"),s.appendChild(l);var p=document.createElementNS(K,"circle");return p.setAttribute("cx",.4*e.theme.stoneSize),p.setAttribute("cy",.4*e.theme.stoneSize),p.setAttribute("r",.15*e.theme.stoneSize),p.setAttribute("fill","#fff"),p.setAttribute("filter","url(#"+this.filterElement.id+")"),s.appendChild(p),(i={})[Y]=s,i[X]=this.createShadow(e,r),i},e}(rt),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var o=document.createElementNS(K,"radialGradient");o.setAttribute("id",et("filter")),o.setAttribute("fx","30%"),o.setAttribute("fy","30%"),o.innerHTML='\n        <stop offset="10%" stop-color="rgba(255,255,255,0.9)" />\n        <stop offset="100%" stop-color="rgba(255,255,255,0)" />\n      ',r(o),this.filterElement1=o;var n=document.createElementNS(K,"radialGradient");n.setAttribute("id",et("filter")),n.setAttribute("fx","70%"),n.setAttribute("fy","70%"),n.innerHTML='\n        <stop offset="10%" stop-color="rgba(255,255,255,0.7)" />\n        <stop offset="100%" stop-color="rgba(255,255,255,0)" />\n      ',r(n),this.filterElement2=n}var s=document.createElementNS(K,"g"),a=document.createElementNS(K,"circle");a.setAttribute("cx","0"),a.setAttribute("cy","0"),a.setAttribute("fill","#ccc"),a.setAttribute("r",e.theme.stoneSize),s.appendChild(a);var l=document.createElementNS(K,"circle");l.setAttribute("cx","0"),l.setAttribute("cy","0"),l.setAttribute("r",e.theme.stoneSize),l.setAttribute("fill","url(#"+this.filterElement1.id+")"),s.appendChild(l);var p=document.createElementNS(K,"circle");return p.setAttribute("cx","0"),p.setAttribute("cy","0"),p.setAttribute("r",e.theme.stoneSize),p.setAttribute("fill","url(#"+this.filterElement2.id+")"),s.appendChild(p),(i={})[Y]=s,i[X]=this.createShadow(e,r),i},e}(rt),nt=function(e){function r(t){void 0===t&&(t={});var r=e.call(this,t)||this;return t.maxWidth||0===t.maxWidth||(t.maxWidth=.95),r}return i(r,e),r.prototype.createElement=function(t){var e,r=document.createElementNS(K,"text");r.setAttribute("text-anchor","middle"),r.setAttribute("dominant-baseline","middle"),r.setAttribute("lengthAdjust","spacingAndGlyphs");var i=document.createElementNS(K,"text");return i.setAttribute("text-anchor","middle"),i.setAttribute("dominant-baseline","middle"),i.setAttribute("stroke-width","0.2"),i.setAttribute("stroke","rgba(0,0,0,"+t.theme.markupGridMask+")"),i.setAttribute("lengthAdjust","spacingAndGlyphs"),(e={})[Y]=r,e[U]=i,e},r.prototype.updateElement=function(r,i,o){e.prototype.updateElement.call(this,r,i,o);var n=.5;1===i.text.length?n=.7:2===i.text.length&&(n=.6),this.params.color?r[Y].setAttribute("fill",this.params.color):i.variation===t.Color.B?r[Y].setAttribute("fill",o.theme.markupBlackColor):i.variation===t.Color.W?r[Y].setAttribute("fill",o.theme.markupWhiteColor):r[Y].setAttribute("fill",o.theme.markupNoneColor),r[Y].removeAttribute("stroke"),r[Y].setAttribute("font-family",this.params.font||o.theme.font),r[Y].setAttribute("stroke-width","0"),r[Y].setAttribute("font-size",n),r[Y].textContent=i.text,r[U].setAttribute("font-size",n),r[U].textContent=i.text,this.params.maxWidth>0&&(r[Y].getComputedTextLength()>this.params.maxWidth?(r[Y].setAttribute("textLength",""+this.params.maxWidth),r[U].setAttribute("textLength",""+this.params.maxWidth)):(r[Y].removeAttribute("textLength"),r[U].removeAttribute("textLength")))},r}(Z),st=function(){function t(t){void 0===t&&(t={}),this.params=t}return t.prototype.createElement=function(){var t,e=document.createElementNS(K,"line"),r=document.createElementNS(K,"line");return(t={})[Y]=e,t[U]=r,t},t.prototype.updateElement=function(t,e,r){t[Y].setAttribute("stroke",this.params.color||r.theme.markupNoneColor),t[Y].setAttribute("stroke-width",this.params.lineWidth||r.theme.markupLineWidth),t[Y].setAttribute("x1",e.start.x),t[Y].setAttribute("y1",e.start.y),t[Y].setAttribute("x2",e.end.x),t[Y].setAttribute("y2",e.end.y),t[U].setAttribute("stroke","rgba(0,0,0,"+r.theme.markupGridMask+")"),t[U].setAttribute("stroke-width",2*(this.params.lineWidth||r.theme.markupLineWidth)),t[U].setAttribute("x1",e.start.x),t[U].setAttribute("y1",e.start.y),t[U].setAttribute("x2",e.end.x),t[U].setAttribute("y2",e.end.y)},t}(),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var o=document.createElementNS(K,"radialGradient");o.setAttribute("id",et("filter")),o.setAttribute("cx","45%"),o.setAttribute("cy","45%"),o.setAttribute("fx","20%"),o.setAttribute("fy","20%"),o.setAttribute("r","60%"),o.innerHTML='\n        <stop offset="0%" stop-color="rgba(48,48,48,1)" />\n        <stop offset="80%" stop-color="rgba(16,16,16,1)" />\n        <stop offset="100%" stop-color="rgba(0,0,0,1)" />\n      ',r(o),this.filterElement1=o}var n=document.createElementNS(K,"g"),s=document.createElementNS(K,"circle");return s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","url(#"+this.filterElement1.id+")"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s),(i={})[Y]=n,i[X]=this.createShadow(e,r),i},e}(rt),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(e,r){var i;if(t.prototype.createElement.call(this,e,r),!this.filterElement1){var o=document.createElementNS(K,"radialGradient");o.setAttribute("id",et("filter")),o.setAttribute("cx","45%"),o.setAttribute("cy","45%"),o.setAttribute("fx","20%"),o.setAttribute("fy","20%"),o.setAttribute("r","60%"),o.innerHTML='\n        <stop offset="0%" stop-color="rgba(255,255,255,1)" />\n        <stop offset="80%" stop-color="rgba(215,215,215,1)" />\n        <stop offset="100%" stop-color="rgba(170,170,170,1)" />\n      ',r(o),this.filterElement1=o}var n=document.createElementNS(K,"g"),s=document.createElementNS(K,"circle");return s.setAttribute("cx","0"),s.setAttribute("cy","0"),s.setAttribute("fill","url(#"+this.filterElement1.id+")"),s.setAttribute("r",e.theme.stoneSize),n.appendChild(s),(i={})[Y]=n,i[X]=this.createShadow(e,r),i},e}(rt),pt=function(t){function e(e,r){var i=t.call(this)||this;return i.fallback=r,i.randSeed=Math.ceil(9999999*Math.random()),i.paths=e,i.loadedPaths={},i}return i(e,t),e.prototype.createElement=function(e,r){var i=this;t.prototype.createElement.call(this,e,r);var o,n=Math.floor(Math.random()*this.paths.length),s=document.createElementNS(K,"g");this.loadedPaths[n]||((o=this.fallback.createElement(e,r))instanceof SVGElement||(o=o[Y]),s.appendChild(o));var a=document.createElementNS(K,"image");return a.setAttribute("href",this.paths[n]),a.setAttribute("width",2*e.theme.stoneSize),a.setAttribute("height",2*e.theme.stoneSize),a.setAttribute("x",-e.theme.stoneSize),a.setAttribute("y",-e.theme.stoneSize),this.loadedPaths[n]||a.setAttribute("opacity","0"),a.addEventListener("load",(function(){o&&(a.setAttribute("opacity","1"),s.removeChild(o),i.loadedPaths[n]=!0)})),s.appendChild(a),s},e}(rt),ht=function(t){function e(e){var r=t.call(this)||this;return r.color=e,r}return i(e,t),e.prototype.createElement=function(t){var e=document.createElementNS(K,"circle");return e.setAttribute("cx","0"),e.setAttribute("cy","0"),e.setAttribute("r",t.theme.stoneSize),e.setAttribute("fill",this.color),e},e}(J),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(K,"rect");r.setAttribute("x","-0.25"),r.setAttribute("y","-0.25"),r.setAttribute("width","0.50"),r.setAttribute("height","0.50");var i=document.createElementNS(K,"rect");return i.setAttribute("x","-0.35"),i.setAttribute("y","-0.35"),i.setAttribute("width","0.70"),i.setAttribute("height","0.70"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[Y]=r,e[U]=i,e},e}(Z),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(K,"polygon");r.setAttribute("points","0,-0.25 -0.25,0.166666 0.25,0.166666");var i=document.createElementNS(K,"polygon");return i.setAttribute("points","0,-0.35 -0.35,0.2333333 0.35,0.2333333"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[Y]=r,e[U]=i,e},e}(Z),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createElement=function(t){var e,r=document.createElementNS(K,"path");r.setAttribute("d","M -0.20,-0.20 L 0.20,0.20 M 0.20,-0.20 L -0.20,0.20");var i=document.createElementNS(K,"circle");return i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","0.15"),i.setAttribute("fill","rgba(0,0,0,"+t.theme.markupGridMask+")"),(e={})[Y]=r,e[U]=i,e},e}(Z),ft=Object.freeze({__proto__:null,Arrow:q,Circle:Q,Dim:$,Dot:tt,GlassStoneBlack:it,GlassStoneWhite:ot,Label:nt,Line:st,ModernStoneBlack:at,ModernStoneWhite:lt,RealisticStone:pt,SimpleStone:ht,Square:ct,Triangle:ut,XMark:dt});function mt(t,e,r,i){var o=document.createElementNS(K,"line");return o.setAttribute("x1",t),o.setAttribute("y1",e),o.setAttribute("x2",r),o.setAttribute("y2",i),o}function yt(t,e,r){var i=document.createElementNS(K,"circle");return i.setAttribute("cx",t),i.setAttribute("cy",e),i.setAttribute("r",r),i.setAttribute("fill","#553310"),i.setAttribute("stroke-width","0"),i}function bt(t){var e=t.theme.grid.linesWidth,r=document.createElementNS(K,"g");r.setAttribute("stroke",t.theme.grid.linesColor),r.setAttribute("stroke-width",e.toString()),r.setAttribute("fill",t.theme.grid.starColor);for(var i=0;i<t.size;i++)r.appendChild(mt(i,0-e/2,i,t.size-1+e/2)),r.appendChild(mt(0-e/2,i,t.size-1+e/2,i));var o=t.theme.starPoints[t.size];return o&&o.forEach((function(e){r.appendChild(yt(e.x,e.y,t.theme.grid.starSize))})),r}function gt(t,e,r){var i=document.createElementNS(K,"text");return i.setAttribute("x",t),i.setAttribute("y",e),i.textContent=r,i}function vt(t){var e=document.createElementNS(K,"g");e.style.userSelect="none";var r=t.size,i=t.theme.coordinates,o=i.fontSize,n=i.color,s=i.labelsX,a=i.labelsY,l=i.top,p=i.bottom,h=i.right,c=i.left;e.setAttribute("font-family",t.theme.font),e.setAttribute("font-size",o),e.setAttribute("text-anchor","middle"),e.setAttribute("dominant-baseline","middle"),t.theme.coordinates.bold&&e.setAttribute("font-weight","bold"),e.setAttribute("fill",n);for(var u=0;u<r;u++)l&&e.appendChild(gt(u,-.75,s[u])),p&&e.appendChild(gt(u,r-.25,s[u])),c&&e.appendChild(gt(-.75,r-u-1,a[u])),h&&e.appendChild(gt(r-.25,r-u-1,a[u]));return e}var Ct,Et=o(o({},H),{markupGridMask:.8,stoneSize:.48,coordinates:o(o({},H.coordinates),{fontSize:.5,top:!0,right:!0,bottom:!0,left:!0}),grid:o(o({},H.grid),{linesWidth:.03,starSize:.09}),drawHandlers:{CR:new Q,SQ:new ct,LB:new nt,TR:new ut,MA:new dt({lineWidth:.075}),SL:new tt({color:"rgba(32, 32, 192, 0.75)"}),LN:new st,AR:new q,DD:new $({color:"rgba(0, 0, 0, 0.5)"}),W:new lt,B:new at}}),At=o(o({},D),{theme:Et}),xt=function(t){function e(e,r){void 0===r&&(r={});var i=t.call(this,e,V(At,r))||this;return i.objects=[],i.contexts={},i.boardElement=document.createElement("div"),i.boardElement.style.display="inline-block",i.boardElement.style.position="relative",i.boardElement.style.verticalAlign="middle",i.boardElement.style.userSelect="none",i.element.appendChild(i.boardElement),i.touchArea=document.createElement("div"),i.touchArea.style.position="absolute",i.touchArea.style.top="0",i.touchArea.style.left="0",i.touchArea.style.bottom="0",i.touchArea.style.right="0",i.touchArea.style.zIndex="1",i.touchArea.style.borderTop="#F0E7A7 solid 1px",i.touchArea.style.borderRight="#D1A974 solid 1px",i.touchArea.style.borderLeft="#CCB467 solid 1px",i.touchArea.style.borderBottom="#665926 solid 1px",i.boardElement.appendChild(i.touchArea),i.svgElement=document.createElementNS(K,"svg"),i.svgElement.style.display="block",i.boardElement.appendChild(i.svgElement),i.defsElement=document.createElementNS(K,"defs"),i.svgElement.appendChild(i.defsElement),i.setViewport(),i.resize(),i.redraw(),i}return i(e,t),e.prototype.resize=function(){this.config.width&&this.config.height?(this.boardElement.style.width="",this.svgElement.style.width=this.config.width+"px",this.svgElement.style.height=this.config.height+"px"):this.config.width?(this.boardElement.style.width="",this.svgElement.style.width=this.config.width+"px",this.svgElement.style.height="auto"):this.config.height?(this.boardElement.style.width="",this.svgElement.style.width="auto",this.svgElement.style.height=this.config.height+"px"):(this.boardElement.style.width="100%",this.svgElement.style.width="100%",this.svgElement.style.height="auto")},e.prototype.redraw=function(){this.svgElement.style.backgroundColor=this.config.theme.backgroundColor,this.config.theme.backgroundImage?this.svgElement.style.backgroundImage="url('"+this.config.theme.backgroundImage+"')":this.svgElement.style.backgroundImage="",this.drawGrid(),this.drawCoordinates(),this.drawObjects()},e.prototype.drawGrid=function(){this.contexts[U]&&this.svgElement.removeChild(this.contexts[U]),this.contexts.gridElement&&this.svgElement.removeChild(this.contexts.gridElement);var t=this.config.size;this.contexts[U]=document.createElementNS(K,"mask"),this.contexts[U].id=et("mask"),this.contexts[U].innerHTML='<rect x="-0.5" y="-0.5" width="'+t+'" height="'+t+'" fill="white" />',this.svgElement.appendChild(this.contexts[U]),this.contexts.gridElement=bt(this.config),this.contexts.gridElement.setAttribute("mask","url(#"+this.contexts[U].id+")"),this.svgElement.appendChild(this.contexts.gridElement)},e.prototype.drawCoordinates=function(){this.contexts.coordinatesElement&&this.svgElement.removeChild(this.contexts.coordinatesElement),this.contexts.coordinatesElement=vt(this.config),this.contexts.coordinatesElement.style.opacity=this.config.coordinates?"":"0",this.svgElement.appendChild(this.contexts.coordinatesElement)},e.prototype.drawObjects=function(){var t=this;this.contexts[X]&&this.svgElement.removeChild(this.contexts[X]),this.contexts[Y]&&this.svgElement.removeChild(this.contexts[Y]),this.contexts[X]=document.createElementNS(K,"g"),this.svgElement.appendChild(this.contexts[X]),this.contexts[Y]=document.createElementNS(K,"g"),this.svgElement.appendChild(this.contexts[Y]),this.objectsElementMap=new Map,this.objects.forEach((function(e){return t.createObjectElements(e)}))},e.prototype.addObject=function(e){if(t.prototype.addObject.call(this,e),!Array.isArray(e)){if(this.objectsElementMap.get(e))return void this.updateObject(e);this.createObjectElements(e)}},e.prototype.createObjectElements=function(t){var e,r,i=this,o=this.getObjectHandler(t),n=o.createElement(this.config,(function(t){return i.defsElement.appendChild(t)}));n instanceof SVGElement?((e={})[Y]=n,r=e):r=n,this.objectsElementMap.set(t,r),Object.keys(r).forEach((function(t){return i.contexts[t].appendChild(r[t])})),o.updateElement(r,t,this.config)},e.prototype.getObjectHandler=function(t){return"handler"in t?t.handler:this.config.theme.drawHandlers[t.type]},e.prototype.removeObject=function(e){var r=this;if(t.prototype.removeObject.call(this,e),!Array.isArray(e)){var i=this.objectsElementMap.get(e);i&&(this.objectsElementMap.delete(e),Object.keys(i).forEach((function(t){return r.contexts[t].removeChild(i[t])})))}},e.prototype.updateObject=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.updateObject(t[e]);else{var r=this.objectsElementMap.get(t);r&&this.getObjectHandler(t).updateElement(r,t,this.config)}},e.prototype.setViewport=function(e){void 0===e&&(e=this.config.viewport),t.prototype.setViewport.call(this,e);var r=this.config,i=r.coordinates,o=r.theme,n=r.size,s=o.marginSize,a=o.coordinates,l=a.fontSize,p=a.top,h=a.left,c=a.bottom,u=a.right;this.top=e.top-.5-(i&&p&&!e.top?l:0)-s,this.left=e.left-.5-(i&&h&&!e.left?l:0)-s,this.bottom=n-.5-this.top-e.bottom+(i&&c&&!e.bottom?l:0)+s,this.right=n-.5-this.left-e.right+(i&&u&&!e.right?l:0)+s,this.svgElement.setAttribute("viewBox",this.left+" "+this.top+" "+this.right+" "+this.bottom)},e.prototype.setSize=function(e){void 0===e&&(e=19),t.prototype.setSize.call(this,e),this.drawGrid(),this.drawCoordinates(),this.setViewport()},e.prototype.setCoordinates=function(e){t.prototype.setCoordinates.call(this,e),this.contexts.coordinatesElement.style.opacity=this.config.coordinates?"":"0",this.setViewport()},e.prototype.on=function(e,r){t.prototype.on.call(this,e,r),this.registerBoardListener(e)},e.prototype.registerBoardListener=function(t){var e=this;this.touchArea.addEventListener(t,(function(r){if(null!=r.layerX){var i=e.getRelativeCoordinates(r.layerX,r.layerY);e.emit(t,r,i)}else e.emit(t,r)}))},e.prototype.getRelativeCoordinates=function(t,e){var r=this.touchArea.offsetWidth/this.right,i=this.touchArea.offsetHeight/this.bottom,o=Math.round(t/r+this.left),n=Math.round(e/i+this.top);return o<0||o>=this.config.size||n<0||n>=this.config.size?null:{x:o,y:n}},e}(F);function Nt(t){t.target.params.size=t.value}function wt(t){T[t.value]&&(t.target.params.rules=T[t.value])}function St(e){e.value>1&&e.target.currentNode===e.target.rootNode&&!e.target.getProperty(Ct.SET_TURN)&&(e.target.game.position.turn=t.Color.WHITE)}function Ot(e){var r="B"===e.propIdent?t.Color.B:t.Color.W;e.value&&e.target.game.position.applyMove(e.value.x,e.value.y,r,!0,!0),e.target.game.position.turn=-r}function _t(t){t.target.game.turn=t.value}function Mt(e){var r;switch(e.propIdent){case"AB":r=t.Color.B;break;case"AW":r=t.Color.W;break;case"AE":r=t.Color.E}e.value.forEach((function(t){e.target.game.setStone(t.x,t.y,r)}))}!function(t){t.BLACK_MOVE="B",t.EXECUTE_ILLEGAL="KO",t.MOVE_NUMBER="MN",t.WHITE_MOVE="W",t.ADD_BLACK="AB",t.CLEAR_FIELD="AE",t.ADD_WHITE="AW",t.SET_TURN="PL",t.COMMENT="C",t.EVEN_POSITION="DM",t.GOOD_FOR_BLACK="GB",t.GOOD_FOR_WHITE="GW",t.HOTSPOT="HO",t.NODE_NAME="N",t.UNCLEAR_POSITION="UC",t.NODE_VALUE="V",t.BAD_MOVE="BM",t.DOUBTFUL_MOVE="DM",t.INTERESTING_MOVE="IT",t.GOOD_MOVE="TE",t.ARROW="AR",t.CIRCLE="CR",t.DIM="DD",t.LABEL="LB",t.LINE="LN",t.X_MARK="MA",t.SELECTED="SL",t.SQUARE="SQ",t.TRIANGLE="TR",t.APPLICATION="AP",t.CHARSET="CA",t.SGF_VERSION="FF",t.GAME_TYPE="GM",t.VARIATIONS_STYLE="ST",t.BOARD_SIZE="SZ",t.ANNOTATOR="AN",t.BLACK_RANK="BR",t.BLACK_TEAM="BT",t.COPYRIGHT="CP",t.DATE="DT",t.EVENT="EV",t.GAME_NAME="GN",t.GAME_COMMENT="GC",t.OPENING_INFO="ON",t.OVER_TIME="OT",t.BLACK_NAME="BN",t.PLACE="PC",t.WHITE_NAME="PW",t.RESULT="RE",t.ROUND="RO",t.RULES="RU",t.SOURCE="SO",t.TIME_LIMITS="TM",t.AUTHOR="US",t.WHITE_RANK="WR",t.WHITE_TEAM="WT",t.BLACK_TIME_LEFT="BL",t.BLACK_STONES_LEFT="OB",t.WHITE_STONES_LEFT="OW",t.WHITE_TIME_LEFT="WL",t.FIGURE="FG",t.PRINT_MOVE_NUMBERS="PM",t.BOARD_SECTION="VW",t.HANDICAP="HA",t.KOMI="KM",t.BLACK_TERRITORY="TB",t.WHITE_TERRITORY="TW"}(Ct||(Ct={}));var kt=function(e){function r(){var t=e.call(this)||this;return t.loadKifu(new S),t.plugins=[],t.on("beforeInit.SZ",Nt),t.on("beforeInit.RU",wt),t.on("applyGameChanges.HA",St),t.on("applyGameChanges.B",Ot),t.on("applyGameChanges.W",Ot),t.on("applyGameChanges.PL",_t),t.on("applyGameChanges.AB",Mt),t.on("applyGameChanges.AW",Mt),t.on("applyGameChanges.AE",Mt),t}return i(r,e),r.prototype.loadKifu=function(t){this.rootNode=t,this.currentNode=t,this.emit("loadKifu",{name:"loadKifu",kifuNode:t,target:this}),this.executeRoot()},r.prototype.newGame=function(t,e){var r=new S;if(t&&r.setProperty("SZ",t),e){var i=Object.keys(T).find((function(t){return T[t]===e}));i&&r.setProperty("RU",i)}this.loadKifu(r)},r.prototype.executeRoot=function(){this.params={size:19,rules:O},this.emitNodeLifeCycleEvent("beforeInit"),this.game=new B(this.params.size,this.params.rules),this.executeNode()},r.prototype.executeNode=function(){this.emitNodeLifeCycleEvent("applyGameChanges"),this.emitNodeLifeCycleEvent("applyNodeChanges")},r.prototype.executeNext=function(t){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.game.pushPosition(this.game.position.clone()),this.currentNode=this.currentNode.children[t],this.executeNode()},r.prototype.executePrevious=function(){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.emitNodeLifeCycleEvent("clearGameChanges"),this.game.popPosition(),this.currentNode=this.currentNode.parent,this.emitNodeLifeCycleEvent("applyNodeChanges")},r.prototype.emitNodeLifeCycleEvent=function(t){var e=this;this.emit(t,{name:t,target:this}),this.currentNode.forEachProperty((function(r,i){e.emit(t+"."+r,{name:t,target:e,propIdent:r,value:i})}))},r.prototype.getPropertyHandler=function(t){return this.constructor.propertyHandlers[t]},r.prototype.getProperty=function(t){return this.currentNode.getProperty(t)},r.prototype.setProperty=function(t,e){this.emitNodeLifeCycleEvent("clearNodeChanges"),this.emitNodeLifeCycleEvent("clearGameChanges"),this.currentNode.setProperty(t,e),this.executeNode()},r.prototype.getRootProperty=function(t){return this.rootNode.getProperty(t)},r.prototype.getNextNodes=function(){return this.currentNode.children},r.prototype.next=function(t){if(void 0===t&&(t=0),this.currentNode.children.length){var e=void 0;if(e="number"===typeof t?t:this.currentNode.children.indexOf(t),this.currentNode.children[e])return this.executeNext(e),!0}return!1},r.prototype.previous=function(){return!!this.currentNode.parent&&(this.executePrevious(),!0)},r.prototype.first=function(){for(;this.previous(););},r.prototype.last=function(){for(;this.next(););},r.prototype.goTo=function(t){var e="number"===typeof t?{depth:t,forks:[]}:t;this.first();for(var r=0,i=0;r<e.depth;r++)this.currentNode.children.length>1?this.next(e.forks[i++]):this.next()},r.prototype.getCurrentPath=function(){var t={depth:0,forks:[]};if(this.currentNode)for(var e=this.currentNode;e.parent;)t.depth++,e.parent.children.length>1&&t.forks.push(e.parent.children.indexOf(e)),e=e.parent;return t},r.prototype.previousFork=function(){for(;this.previous();)if(this.currentNode.children.length>1)return},r.prototype.play=function(e,r){var i=new S;this.game.turn===t.Color.W?i.setProperty(Ct.WHITE_MOVE,{x:e,y:r}):i.setProperty(Ct.BLACK_MOVE,{x:e,y:r});var o=this.currentNode.appendChild(i);this.next(o)},r.prototype.use=function(t){if(!t||"function"!==typeof t.apply)throw new TypeError("Plugin must implement an `apply` method.");t.apply(this),this.plugins.push(t)},r}(z),Tt={enabled:!1,showVariations:!0},Pt=function(){function e(t){var e=this;void 0===t&&(t={}),this.gameStateStack=[],this.handleChange=function(t){t&&!e.config.enabled?e.enable():!t&&e.config.enabled&&e.disable()},this.config=V(Tt,t)}return e.prototype.apply=function(t){if(this.player)throw new Error("This plugin instance has already been applied to a player object.");this.player=t,this.player.on("editMode.change",this.handleChange),this.config.enabled&&this.enable()},e.prototype.setEnabled=function(t){t!==this.config.enabled&&this.player.emit("editMode.change",t)},e.prototype.play=function(t){if(this.config.enabled){for(var e=0;e<this.player.currentNode.children.length;e++){var r=this.player.currentNode.children[e],i=r.getProperty("B")||r.getProperty("W");if(i.x===t.x&&i.y===t.y)return void this.player.next(e)}this.player.game.isValid(t.x,t.y)&&this.player.play(t.x,t.y)}},e.prototype.enable=function(){var e=this;this.saveGameState(),this.config.showVariations?this.player.rootNode.setProperty(Ct.VARIATIONS_STYLE,0):this.player.rootNode.setProperty(Ct.VARIATIONS_STYLE,2),this.config.enabled=!0;var r=-1,i=-1,o=new I("B");o.opacity=.35;var n=new I("W");n.opacity=.35;var s=null;this._boardMouseMoveEvent=function(a){if(r!==a.x||i!==a.y){if(e.player.game.isValid(a.x,a.y)){var l=e.player.game.turn===t.Color.BLACK?o:n;l.setPosition(a.x,a.y),s?e.player.emit("board.updateTemporaryObject",l):(e.player.emit("board.addTemporaryObject",l),s=l)}else e._boardMouseOutEvent();r=a.x,i=a.y}},this._boardMouseOutEvent=function(){s&&(e.player.emit("board.removeTemporaryObject",s),s=null),r=-1,i=-1},this._boardClickEvent=function(t){e._boardMouseOutEvent(),null!=t&&e.play(t)},this._nodeChange=function(){var t={x:r,y:i};e._boardMouseOutEvent(),e._boardMouseMoveEvent(t)},this.player.on("board.mouseMove",this._boardMouseMoveEvent),this.player.on("board.mouseOut",this._boardMouseOutEvent),this.player.on("board.click",this._boardClickEvent),this.player.on("applyNodeChanges",this._nodeChange)},e.prototype.disable=function(){this.player.off("board.mouseMove",this._boardMouseMoveEvent),this.player.off("board.mouseOut",this._boardMouseOutEvent),this.player.off("board.click",this._boardClickEvent),this.player.off("applyNodeChanges",this._nodeChange),this.config.enabled=!1,this.restoreGameState()},e.prototype.saveGameState=function(){this.gameStateStack.push({rootNode:this.player.rootNode.cloneNode(),path:this.player.getCurrentPath()})},e.prototype.restoreGameState=function(){var t=this.gameStateStack.pop();t&&(this.player.first(),this.player.loadKifu(t.rootNode),this.player.goTo(t.path))},e}(),Lt={enableMouseWheel:!0,enableKeys:!0,fastReplay:2e3},Bt=function(t){function e(e){void 0===e&&(e={});var r=t.call(this)||this;return r.components=new Map,r.fastReplayEnabled=!1,r.handleResize=function(){r.emit("resize")},r.handleMouseWheel=function(t){r.config.enableMouseWheel&&(t.deltaY>0?r.next():t.deltaY<0&&r.previous(),t.preventDefault())},r.handleKeydown=function(t){if(r.config.enableKeys&&r.hasFocus())return r.config.fastReplay>=0&&!r.fastReplayTimeout&&(r.fastReplayTimeout=window.setTimeout((function(){r.fastReplayEnabled=!0}),r.config.fastReplay)),"ArrowRight"===t.key?(r.next(),r.fastReplayEnabled&&(r.next(),r.next())):"ArrowLeft"===t.key&&(r.previous(),r.fastReplayEnabled&&(r.previous(),r.previous())),!1},r.handleKeyup=function(){window.clearTimeout(r.fastReplayTimeout),r.fastReplayTimeout=null,r.fastReplayEnabled=!1},r.config=V(Lt,e),window.addEventListener("resize",r.handleResize),document.addEventListener("keydown",r.handleKeydown),document.addEventListener("keyup",r.handleKeyup),r}return i(e,t),e.prototype.render=function(t,e){e.innerHTML="";var r=this.createWrapper();e.appendChild(r),r.appendChild(t.element),t.create(this),this.components.set(e,t)},e.prototype.clear=function(t){var e=this.components.get(t);e&&"function"===typeof e.destroy&&e.destroy();var r=t.firstChild;r.removeEventListener("wheel",this.handleMouseWheel),t.removeChild(r),this.components.delete(t)},e.prototype.createWrapper=function(){var t=document.createElement("div");return t.className="wgo-player",t.tabIndex=1,t.addEventListener("wheel",this.handleMouseWheel),t},e.prototype.hasFocus=function(){var t,e;try{for(var r=n(this.components.keys()),i=r.next();!i.done;i=r.next())if(i.value.firstChild===document.activeElement)return!0}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return!1},e}(kt),Rt=function(){function t(t,e){var r=this;void 0===e&&(e=[]),this.direction=t,this.children=e,this.element=document.createElement("div"),this.element.className="wgo-player__container wgo-player__container--"+this.direction,this.children.forEach((function(t){return r.element.appendChild(t.element)}))}return t.prototype.create=function(t){this.children.forEach((function(e){return e.create(t)}))},t.prototype.destroy=function(){this.children.forEach((function(t){return"function"===typeof t.destroy&&t.destroy()}))},t}(),It={gameInfoProperties:{DT:"Date",KM:"Komi",HA:"Handicap",AN:"Annotations",CP:"Copyright",GC:"Game comments",GN:"Game name",ON:"Fuseki",OT:"Overtime",TM:"Basic time",RE:"Result",RO:"Round",RU:"Rules",US:"Recorder",PC:"Place",EV:"Event",SO:"Source"},hideResult:!0},Gt=function(){function t(t){void 0===t&&(t={}),this.config=V(It,t),this.printInfo=this.printInfo.bind(this),this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__box--content";var e=document.createElement("div");e.innerHTML="Game information",e.className="wgo-player__box__title",this.element.appendChild(e);var r=document.createElement("div");r.className="wgo-player__box__content",this.element.appendChild(r),this.infoTable=document.createElement("table"),this.infoTable.className="wgo-player__box__game-info",r.appendChild(this.infoTable)}return t.prototype.create=function(t){this.player=t,this.player.on("beforeInit",this.printInfo),this.printInfo()},t.prototype.destroy=function(){this.player.off("beforeInit",this.printInfo),this.player=null},t.prototype.addInfo=function(t,e,r){var i=document.createElement("tr");i.dataset.propIdent=t,this.infoTable.appendChild(i);var o=document.createElement("th");o.textContent=this.config.gameInfoProperties[t],i.appendChild(o);var n=document.createElement("td");if(r){var s=document.createElement("a");s.href="#",s.addEventListener("click",(function(t){t.preventDefault(),n.textContent=e})),s.textContent="show",n.appendChild(s)}else n.textContent=e;i.appendChild(n)},t.prototype.removeInfo=function(t){var e=this.infoTable.querySelector("[data-id='"+t+"']");this.infoTable.removeChild(e)},t.prototype.printInfo=function(){var t=this;this.infoTable.innerHTML="",this.player.rootNode&&this.player.rootNode.forEachProperty((function(e,r){t.config.gameInfoProperties[e]&&t.addInfo(e,r,t.config.hideResult&&e===Ct.RESULT)}))},t}(),jt={menuItems:[]},Wt=function(){function t(t){void 0===t&&(t={}),this.config=V(jt,t),this.update=this.update.bind(this),this.createDOM()}return t.prototype.createDOM=function(){var t=this;this.element=document.createElement("div"),this.element.className="wgo-player__control-panel";var e=document.createElement("form");if(e.className="wgo-player__button-group",this.element.appendChild(e),e.addEventListener("submit",(function(e){e.preventDefault(),t.player.goTo(parseInt(t.moveNumber.value,10))})),this.first=document.createElement("button"),this.first.type="button",this.first.className="wgo-player__button",this.first.innerHTML='<span class="wgo-player__icon-to-end wgo-player__icon--reverse"></span>',this.first.addEventListener("click",(function(){return t.player.first()})),e.appendChild(this.first),this.previous=document.createElement("button"),this.previous.type="button",this.previous.className="wgo-player__button",this.previous.innerHTML='<span class="wgo-player__icon-play wgo-player__icon--reverse"></span>',this.previous.addEventListener("click",(function(){return t.player.previous()})),e.appendChild(this.previous),this.moveNumber=document.createElement("input"),this.moveNumber.className="wgo-player__button wgo-player__move-number",this.moveNumber.value="0",this.moveNumber.addEventListener("blur",(function(e){t.player.goTo(parseInt(t.moveNumber.value,10))})),e.appendChild(this.moveNumber),this.next=document.createElement("button"),this.next.type="button",this.next.className="wgo-player__button",this.next.innerHTML='<span class="wgo-player__icon-play"></span>',this.next.addEventListener("click",(function(){return t.player.next()})),e.appendChild(this.next),this.last=document.createElement("button"),this.last.type="button",this.last.className="wgo-player__button",this.last.innerHTML='<span class="wgo-player__icon-to-end"></span>',this.last.addEventListener("click",(function(){return t.player.last()})),e.appendChild(this.last),this.config.menuItems.length){var r=document.createElement("div");r.className="wgo-player__menu-wrapper",this.element.appendChild(r);var i=document.createElement("button");i.type="button",i.className="wgo-player__button wgo-player__button--menu",i.innerHTML='<span class="wgo-player__icon-menu"></span>',r.appendChild(i);var o=document.createElement("div");o.className="wgo-player__menu",this.createMenuItems(o),r.appendChild(o)}},t.prototype.create=function(t){this.player=t,this.player.on("applyNodeChanges",this.update),this.player.currentNode&&this.update()},t.prototype.destroy=function(){this.player.off("applyNodeChanges",this.update),this.player=null},t.prototype.update=function(){this.moveNumber.value=String(this.player.getCurrentPath().depth),this.player.currentNode.parent?(this.first.disabled=!1,this.previous.disabled=!1):(this.first.disabled=!0,this.previous.disabled=!0),0===this.player.currentNode.children.length?(this.next.disabled=!0,this.last.disabled=!0):(this.next.disabled=!1,this.last.disabled=!1)},t.prototype.createMenuItems=function(t){this.config.menuItems.forEach((function(e){var r=document.createElement("a");r.className="wgo-player__menu-item",r.tabIndex=0,r.textContent=e.name,r.href="javascript: void(0)",e.defaultChecked&&e.defaultChecked()&&r.classList.add("wgo-player__menu-item--checked"),r.addEventListener("click",(function(t){t.preventDefault();var i=e.handleClick();e.checkable&&(i?r.classList.add("wgo-player__menu-item--checked"):r.classList.remove("wgo-player__menu-item--checked")),r.blur()})),t.appendChild(r)}))},t.menuItems={download:function(t){return{name:"Download SGF",handleClick:function(){var e=t.rootNode.getProperty(Ct.GAME_NAME)||"game",r=t.rootNode.toSGF(),i=document.createElement("a");i.setAttribute("href","data:application/x-go-sgf;charset=utf-8,"+encodeURIComponent(r)),i.setAttribute("download",e+".sgf"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}},displayCoordinates:function(t){return{name:"Display coordinates",checkable:!0,handleClick:function(){return t.setCoordinates(!t.config.coordinates),t.config.coordinates},defaultChecked:function(){return t.config.coordinates}}},editMode:function(t){return{name:"Edit mode",checkable:!0,handleClick:function(){return t.setEnabled(!t.config.enabled),t.config.enabled},defaultChecked:function(){return t.config.enabled}}},gameInfo:function(t,e){return{name:"Game info",handleClick:function(){var r=document.createElement("div");r.className="wgo-player__overlay";var i=document.createElement("div");i.className="wgo-player__overlay__close",i.addEventListener("click",(function(){r.parentElement.removeChild(r),s.destroy()})),r.appendChild(i);var o=document.createElement("div");o.className="wgo-player__modal",r.appendChild(o);var n=document.createElement("div");n.className="wgo-player__modal__content",o.appendChild(n);var s=new Gt({hideResult:!1});s.create(t),n.appendChild(s.element);var a=document.createElement("div");a.className="wgo-player__wgo-info",a.innerHTML='Game viewed in open source JS player <a href="https://github.com/waltheri/wgo.js" target="_blank">WGo</a>.',n.appendChild(a),e(r)}}}},t}(),zt=function(t){function e(e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=t.call(this,"custom",r,i)||this;return o.handler=e,o}return i(e,t),e}(I),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(j),Ht={B:t.Color.BLACK,W:t.Color.WHITE},Dt={coordinates:!0,currentMoveBlackMark:new Q({color:"rgba(255,255,255,0.8)",fillColor:"rgba(0,0,0,0)"}),currentMoveWhiteMark:new Q({color:"rgba(0,0,0,0.8)",fillColor:"rgba(0,0,0,0)"}),variationDrawHandler:new nt({color:"#33f"}),highlightCurrentMove:!0,showVariations:!0,showCurrentVariations:!1},Ft=function(){function e(t){void 0===t&&(t={}),this.config=V(Dt,t),this.viewportStack=[],this.applyNodeChanges=this.applyNodeChanges.bind(this),this.clearNodeChanges=this.clearNodeChanges.bind(this),this.applyMarkupProperty=this.applyMarkupProperty.bind(this),this.applyLabelMarkupProperty=this.applyLabelMarkupProperty.bind(this),this.applyLineMarkupProperty=this.applyLineMarkupProperty.bind(this),this.applyViewportProperty=this.applyViewportProperty.bind(this),this.clearViewportProperty=this.clearViewportProperty.bind(this),this.applyMoveProperty=this.applyMoveProperty.bind(this),this.addTemporaryBoardObject=this.addTemporaryBoardObject.bind(this),this.removeTemporaryBoardObject=this.removeTemporaryBoardObject.bind(this),this.updateTemporaryBoardObject=this.updateTemporaryBoardObject.bind(this),this.setCoordinates=this.setCoordinates.bind(this),this.createDOM()}return e.prototype.createDOM=function(){var t=this;this.element=document.createElement("div"),this.element.className="wgo-player__board",this.stoneBoardsObjects=[],this.temporaryBoardObjects=[],this.board=new xt(this.element,{coordinates:this.config.coordinates,theme:this.config.theme}),this.board.on("click",(function(e,r){t.handleBoardClick(r)})),this.board.on("mousemove",(function(e,r){r?r.x===t.boardMouseX&&r.y===t.boardMouseY||(t.boardMouseX=r.x,t.boardMouseY=r.y,t.handleBoardMouseMove(r)):null!=t.boardMouseX&&(t.boardMouseX=null,t.boardMouseY=null,t.handleBoardMouseOut())})),this.board.on("mouseout",(function(e,r){if(!r&&null!=t.boardMouseX)return t.boardMouseX=null,t.boardMouseY=null,void t.handleBoardMouseOut()}))},e.prototype.create=function(t){this.player=t,this.player.on("applyNodeChanges",this.applyNodeChanges),this.player.on("clearNodeChanges",this.clearNodeChanges),this.player.on("applyNodeChanges.CR",this.applyMarkupProperty),this.player.on("applyNodeChanges.TR",this.applyMarkupProperty),this.player.on("applyNodeChanges.SQ",this.applyMarkupProperty),this.player.on("applyNodeChanges.SL",this.applyMarkupProperty),this.player.on("applyNodeChanges.MA",this.applyMarkupProperty),this.player.on("applyNodeChanges.DD",this.applyMarkupProperty),this.player.on("applyNodeChanges.LB",this.applyLabelMarkupProperty),this.player.on("applyNodeChanges.LN",this.applyLineMarkupProperty),this.player.on("applyNodeChanges.AR",this.applyLineMarkupProperty),this.player.on("applyGameChanges.VW",this.applyViewportProperty),this.player.on("clearGameChanges.VW",this.clearViewportProperty),this.player.on("applyNodeChanges.B",this.applyMoveProperty),this.player.on("applyNodeChanges.W",this.applyMoveProperty),this.player.on("board.addTemporaryObject",this.addTemporaryBoardObject),this.player.on("board.removeTemporaryObject",this.removeTemporaryBoardObject),this.player.on("board.updateTemporaryObject",this.updateTemporaryBoardObject),this.player.on("board.setCoordinates",this.setCoordinates)},e.prototype.destroy=function(){this.player.off("applyNodeChanges",this.applyNodeChanges),this.player.off("clearNodeChanges",this.clearNodeChanges),this.player.off("applyNodeChanges",this.applyNodeChanges),this.player.off("clearNodeChanges",this.clearNodeChanges),this.player.off("applyNodeChanges.CR",this.applyMarkupProperty),this.player.off("applyNodeChanges.TR",this.applyMarkupProperty),this.player.off("applyNodeChanges.SQ",this.applyMarkupProperty),this.player.off("applyNodeChanges.SL",this.applyMarkupProperty),this.player.off("applyNodeChanges.MA",this.applyMarkupProperty),this.player.off("applyNodeChanges.DD",this.applyMarkupProperty),this.player.off("applyNodeChanges.LB",this.applyLabelMarkupProperty),this.player.off("applyNodeChanges.LN",this.applyLineMarkupProperty),this.player.off("applyNodeChanges.AR",this.applyLineMarkupProperty),this.player.off("applyGameChanges.VW",this.applyViewportProperty),this.player.off("clearGameChanges.VW",this.clearViewportProperty),this.player.off("applyNodeChanges.B",this.applyMoveProperty),this.player.off("applyNodeChanges.W",this.applyMoveProperty),this.player.off("board.addTemporaryObject",this.addTemporaryBoardObject),this.player.off("board.removeTemporaryObject",this.removeTemporaryBoardObject),this.player.off("board.updateTemporaryObject",this.updateTemporaryBoardObject),this.player.off("board.setCoordinates",this.setCoordinates),this.player=null},e.prototype.updateStones=function(){var e=this;this.stoneBoardsObjects=this.stoneBoardsObjects.filter((function(t){return e.player.game.getStone(t.x,t.y)===Ht[t.type]||(e.board.removeObject(t),!1)}));for(var r=this.player.game.position,i=function(e){for(var i=function(i){var n=r.get(e,i);if(n&&!o.stoneBoardsObjects.some((function(t){return t.x===e&&t.y===i&&n===Ht[t.type]}))){var s=new I(n===t.Color.B?"B":"W",e,i);o.board.addObject(s),o.stoneBoardsObjects.push(s)}},n=0;n<r.size;n++)i(n)},o=this,n=0;n<r.size;n++)i(n)},e.prototype.addVariationMarkup=function(){var t=this,e=this.getVariations();e.length>1&&(e.forEach((function(e,r){if(e){var i=new Vt(String.fromCodePoint(65+r),e.x,e.y);i.handler=t.config.variationDrawHandler,t.addTemporaryBoardObject(i)}})),null!=this.boardMouseX&&this.handleVariationCursor(this.boardMouseX,this.boardMouseY,e))},e.prototype.clearTemporaryBoardObjects=function(){this.temporaryBoardObjects.length&&(this.board.removeObject(this.temporaryBoardObjects),this.temporaryBoardObjects=[])},e.prototype.handleBoardClick=function(t){this.player.emit("board.click",t);var e=this.getVariations();if(e.length>1){var r=e.findIndex((function(e){return e&&e.x===t.x&&e.y===t.y}));r>=0&&(this.shouldShowCurrentVariations()?(this.player.previous(),this.player.next(r)):this.player.next(r))}},e.prototype.handleBoardMouseMove=function(t){this.player.emit("board.mouseMove",t),this.handleVariationCursor(t.x,t.y,this.getVariations())},e.prototype.handleBoardMouseOut=function(){this.player.emit("board.mouseOut"),this.removeVariationCursor()},e.prototype.handleVariationCursor=function(t,e,r){r.length>1&&r.findIndex((function(r){return r&&r.x===t&&r.y===e}))>=0?this.element.style.cursor="pointer":this.removeVariationCursor()},e.prototype.removeVariationCursor=function(){this.element.style.cursor&&(this.element.style.cursor="")},e.prototype.applyNodeChanges=function(){this.updateStones(),this.addVariationMarkup()},e.prototype.clearNodeChanges=function(){this.clearTemporaryBoardObjects(),this.removeVariationCursor()},e.prototype.applyMarkupProperty=function(t){var e=this;t.value.forEach((function(r){var i=new G(t.propIdent,r.x,r.y,e.player.game.getStone(r.x,r.y));i.zIndex=10,e.addTemporaryBoardObject(i)}))},e.prototype.applyLabelMarkupProperty=function(t){var e=this;t.value.forEach((function(t){var r=new j(t.text,t.x,t.y,e.player.game.getStone(t.x,t.y));r.zIndex=10,e.addTemporaryBoardObject(r)}))},e.prototype.applyLineMarkupProperty=function(t){var e=this;t.value.forEach((function(r){var i=new W(t.propIdent,r[0],r[1]);i.zIndex=10,e.addTemporaryBoardObject(i)}))},e.prototype.applyViewportProperty=function(t){var e=this.board.getViewport();if(this.viewportStack.push(e),t.value){var r=Math.min(t.value[0].x,t.value[1].x),i=Math.min(t.value[0].y,t.value[1].y),o=Math.max(t.value[0].x,t.value[1].x),n=Math.max(t.value[0].y,t.value[1].y);this.board.setViewport({left:r,top:i,right:this.board.getSize()-o-1,bottom:this.board.getSize()-n-1})}else this.board.setViewport({top:0,right:0,bottom:0,left:0})},e.prototype.clearViewportProperty=function(){var t=this.viewportStack.pop();t&&this.board.setViewport(t)},e.prototype.applyMoveProperty=function(t){if(this.config.highlightCurrentMove){if(!t.value)return;if(Yt(t.value,this.player.currentNode.properties))return;if(this.getVariations().length>1&&this.shouldShowCurrentVariations())return;var e=new zt("B"===t.propIdent?this.config.currentMoveBlackMark:this.config.currentMoveWhiteMark,t.value.x,t.value.y);e.zIndex=10,this.addTemporaryBoardObject(e)}},e.prototype.addTemporaryBoardObject=function(t){this.temporaryBoardObjects.push(t),this.board.addObject(t)},e.prototype.removeTemporaryBoardObject=function(t){this.temporaryBoardObjects=this.temporaryBoardObjects.filter((function(e){return e!==t})),this.board.removeObject(t)},e.prototype.updateTemporaryBoardObject=function(t){this.board.updateObject(t)},e.prototype.setCoordinates=function(t){this.config.coordinates=t,this.board.setCoordinates(t)},e.prototype.getVariations=function(){if(this.shouldShowVariations()){if(!this.shouldShowCurrentVariations())return this.player.currentNode.children.map((function(t){return t.getProperty("B")||t.getProperty("W")}));if(this.player.currentNode.parent)return this.player.currentNode.parent.children.map((function(t){return t.getProperty("B")||t.getProperty("W")}))}return[]},e.prototype.shouldShowVariations=function(){var t=this.player.rootNode.getProperty(Ct.VARIATIONS_STYLE);return null!=t?!(2&t):this.config.showVariations},e.prototype.shouldShowCurrentVariations=function(){var t=this.player.rootNode.getProperty(Ct.VARIATIONS_STYLE);return null!=t?!!(1&t):this.config.showCurrentVariations},e}();function Kt(t,e){return e&&t.x===e.x&&t.y===e.y}function Yt(t,e){for(var r=Object.keys(e),i=0;i<r.length;i++)if("B"!==r[i]&&"W"!==r[i]){var o=e[r[i]];if(Array.isArray(o)){for(var n=0;n<o.length;n++)if(Kt(t,o[n]))return!0}else if(Kt(t,o))return!0}return!1}var Ut=function(){function t(t,e){this.params=t,this.component=e,this.resize=this.resize.bind(this),this.visible=!0,this.element=this.component.element}return t.prototype.create=function(t){this.player=t,this.player.on("resize",this.resize),this.component.create(this.player),this.resize()},t.prototype.resize=function(){var t=this.shouldRenderComponent();if(this.visible&&!t){var e=this.createPlaceholder();this.element.parentElement.replaceChild(e,this.element),this.element=e,this.visible=!1}else if(!this.visible&&t){var r=this.component.element;this.element.parentElement.replaceChild(r,this.element),this.element=r,this.visible=!0}},t.prototype.destroy=function(){this.player.off("resize",this.resize),this.player=null,"function"===typeof this.component.destroy&&this.component.destroy()},t.prototype.shouldRenderComponent=function(){var t=this.element.parentElement.offsetWidth,e=this.element.parentElement.offsetHeight;return!(null!=this.params.minWidth&&this.params.minWidth>t)&&!(null!=this.params.minHeight&&this.params.minHeight>e)&&!(null!=this.params.maxWidth&&this.params.maxWidth<t)&&!(null!=this.params.maxHeight&&this.params.maxHeight<e)&&!("portrait"===this.params.orientation&&t<e)},t.prototype.createPlaceholder=function(){return document.createComment(" WGo component placeholder for "+(this.component.constructor?this.component.constructor.name:"unknown")+" "+JSON.stringify(this.params)+" ")},t}(),Xt={formatMoves:!0,formatNicks:!0},qt=function(){function t(t){void 0===t&&(t={}),this.config=V(Xt,t),this.setComments=this.setComments.bind(this),this.clearComments=this.clearComments.bind(this),this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__box--content";var e=document.createElement("div");e.innerHTML="Comments",e.className="wgo-player__box__title",this.element.appendChild(e),this.commentsElement=document.createElement("div"),this.commentsElement.className="wgo-player__box__content",this.element.appendChild(this.commentsElement)}return t.prototype.create=function(t){if(this.player=t,this.player.on("applyNodeChanges.C",this.setComments),this.player.on("clearNodeChanges.C",this.clearComments),this.player.currentNode){var e=this.player.currentNode.getProperty("C");e&&this.setComments({value:e})}},t.prototype.destroy=function(){this.player.off("applyNodeChanges.C",this.setComments),this.player.off("clearNodeChanges.C",this.clearComments),this.player=null},t.prototype.setComments=function(t){var e=this;this.commentsElement.innerHTML=this.formatComment(t.value),this.config.formatMoves&&[].forEach.call(this.commentsElement.querySelectorAll(".wgo-player__move-link"),(function(t){var r=Jt(t.textContent,e.player.game.size),i=new G("MA",r.x,r.y,e.player.game.getStone(r.x,r.y));i.zIndex=20,t.addEventListener("mouseenter",(function(){e.player.emit("board.addTemporaryObject",i)})),t.addEventListener("mouseleave",(function(){e.player.emit("board.removeTemporaryObject",i)}))}))},t.prototype.clearComments=function(){this.commentsElement.textContent=""},t.prototype.formatComment=function(t){var e=t.replace(/</g,"&lt;").replace(/>/g,"&gt;");return e="<p>"+e.replace(/\n/g,"</p><p>")+"</p>",this.config.formatNicks&&(e=e.replace(/(<p>)([^:]{3,}:)\s/g,'<p><span class="wgo-player__nick">$2</span> ')),this.config.formatMoves&&(e=e.replace(/\b[a-zA-Z]1?\d\b/g,'<a href="javascript:void(0)" class="wgo-player__move-link">$&</a>')),e},t}();function Jt(t,e){return{x:t.toLowerCase().charCodeAt(0)-97,y:e-1-(parseInt(t.substr(1),10)-1)}}var Zt=function(){function e(e){this.color=e,this.colorChar=e===t.Color.B?"B":"W",this.colorName=e===t.Color.B?"black":"white",this.setName=this.setName.bind(this),this.setRank=this.setRank.bind(this),this.setTeam=this.setTeam.bind(this),this.setCaps=this.setCaps.bind(this),this.element=document.createElement("div"),this.element.className="wgo-player__box wgo-player__player-tag";var r=document.createElement("div");r.className="wgo-player__player-tag__name",this.element.appendChild(r),this.playerNameElement=document.createElement("span"),r.appendChild(this.playerNameElement),this.playerRankElement=document.createElement("small"),this.playerRankElement.className="wgo-player__player-tag__name__rank",r.appendChild(this.playerRankElement),this.playerCapsElement=document.createElement("div"),this.playerCapsElement.className="wgo-player__player-tag__color wgo-player__player-tag__color--"+this.colorName,this.playerCapsElement.textContent="0",this.element.appendChild(this.playerCapsElement),this.playerTeamElement=document.createElement("div")}return e.prototype.create=function(t){this.player=t,this.player.on("beforeInit.P"+this.colorChar,this.setName),this.player.on("beforeInit."+this.colorChar+"R",this.setRank),this.player.on("beforeInit."+this.colorChar+"T",this.setTeam),this.player.on("applyNodeChanges",this.setCaps),this.initialSet()},e.prototype.destroy=function(){this.player.off("beforeInit.P"+this.colorChar,this.setName),this.player.off("beforeInit."+this.colorChar+"R",this.setRank),this.player.off("beforeInit."+this.colorChar+"T",this.setTeam),this.player.off("applyNodeChanges",this.setCaps),this.player=null},e.prototype.setName=function(t){this.playerNameElement.textContent=t.value||this.colorName},e.prototype.setRank=function(t){this.playerRankElement.textContent=t.value},e.prototype.setTeam=function(t){this.playerTeamElement.textContent=t.value},e.prototype.setCaps=function(){this.playerCapsElement.textContent=this.player.game.position.capCount[this.colorName].toString()},e.prototype.initialSet=function(){this.player.rootNode&&(this.playerNameElement.textContent=this.player.rootNode.getProperty("P"+this.colorChar)||this.colorName,this.playerRankElement.textContent=this.player.rootNode.getProperty(this.colorChar+"R")||"",this.playerTeamElement.textContent=this.player.rootNode.getProperty(this.colorChar+"T")||""),this.player.game&&this.setCaps()},e}(),Qt=o(o({},Lt),{board:Dt,comments:o({enabled:!0},Xt),gameInfo:o({enabled:!0},It),sgfFile:null,sgf:null}),$t=function(e){function r(t,r){void 0===r&&(r={});var i=e.call(this)||this;return i.config=V(Qt,r),i.element=t,i.init(),i}return i(r,e),r.prototype.init=function(){var e=this,r=new Pt;this.use(r);var i=new Ft(this.config.board),o={menuItems:[Wt.menuItems.editMode(r),Wt.menuItems.displayCoordinates(i),Wt.menuItems.download(this),Wt.menuItems.gameInfo(this,(function(t){return e.element.firstChild.appendChild(t)}))]},n=[],s=[];this.config.gameInfo.enabled&&n.push(new Gt(this.config.gameInfo)),this.config.comments.enabled&&(n.push(new qt(this.config.comments)),s.push(new Ut({maxWidth:649},new qt(this.config.comments))));var l=new Rt("column",a([new Ut({maxWidth:749},new Rt("row",[new Zt(t.Color.B),new Zt(t.Color.W)])),new Rt("row",[i,new Ut({minWidth:650},new Rt("column",a([new Ut({minWidth:250},new Zt(t.Color.B)),new Ut({minWidth:250},new Zt(t.Color.W)),new Ut({minWidth:250},new Wt(o))],n)))]),new Ut({maxWidth:749},new Wt(o))],s));this.render(l,this.element),this.config.sgf?this.loadKifu(S.fromSGF(this.config.sgf)):this.config.sgfFile&&fetch(this.config.sgfFile).then((function(t){return t.text()})).then((function(t){return e.loadKifu(S.fromSGF(t))}))},r}(Bt);t.BoardBase=F,t.BoardObject=R,t.CHINESE_RULES=_,t.CommentsBox=qt,t.Container=Rt,t.ControlPanel=Wt,t.EditMode=Pt,t.FieldBoardObject=I,t.Game=B,t.GameInfoBox=Gt,t.ING_RULES=M,t.JAPANESE_RULES=O,t.KifuNode=S,t.LabelBoardObject=j,t.LineBoardObject=W,t.MarkupBoardObject=G,t.NO_RULES=k,t.PlayerBase=kt,t.PlayerDOM=Bt,t.PlayerTag=Zt,t.Position=L,t.ResponsiveComponent=Ut,t.SGFParser=d,t.SGFSyntaxError=l,t.SVGBoard=xt,t.SVGBoardComponent=Ft,t.SVGFieldDrawHandler=J,t.SVGMarkupDrawHandler=Z,t.SVGStoneDrawHandler=rt,t.SVG_GRID_MASK=U,t.SVG_NS=K,t.SVG_OBJECTS=Y,t.SVG_SHADOWS=X,t.SimplePlayer=$t,t.goRules=T,t.propertyValueTypes=E,t.svgDrawHandlers=ft,Object.defineProperty(t,"__esModule",{value:!0})}(e)}}]);
//# sourceMappingURL=739.81888a58.chunk.js.map