"use strict";(self.webpackChunkremote_faces_web=self.webpackChunkremote_faces_web||[]).push([[357],{5357:(t,e,o)=>{o.r(e),o.d(e,{GoBoard:()=>u,default:()=>p});var n=o(56167),r=o(35739),s=o(30702),i=o(23463);const c=(t,e,o,c)=>{const l=(0,i.V)(t,e),a=`${c||"go"}Board`;l.extraDataListMap[a]||(l.extraDataListMap[a]=[]);const u=l.extraDataListMap[a];(0,n.useEffect)((()=>{const t=()=>{o(u.flatMap((t=>{try{const e=JSON.parse(t);if((t=>{try{const e=t;return"number"===typeof e.size&&e.grid.length===e.size*e.size&&!e.grid.some((t=>t!==r.Color.B&&t!==r.Color.W&&t!==r.Color.E))&&"number"===typeof e.capCount.black&&"number"===typeof e.capCount.white&&(e.turn===r.Color.B||e.turn===r.Color.W)}catch(e){return!1}})(e))return[e]}catch(e){}return[]})))},e=(0,s.Ld)(u,t);return t(),e}),[u,o]);return{syncUp:(0,n.useCallback)((t=>{u.length<t.length?u.push(...t.slice(u.length).map((t=>JSON.stringify(t)))):u.length>t.length&&u.splice(t.length,u.length-t.length)}),[u])}};var l=o(37878);const a=t=>{const e=new r.Position(t.size);return e.grid=t.grid,e.capCount=t.capCount,e.turn=t.turn,e},u=(0,n.memo)((t=>{let{roomId:e,userId:o,uniqueId:s}=t;const i=(0,n.useRef)(),u=(0,n.useMemo)((()=>{const t=e=>{e.length&&(i.current?i.current.syncDown(e):setTimeout((()=>{t(e)}),1e3))};return t}),[]),{syncUp:p}=c(e,o,u,s),[d,h]=(0,n.useState)("black"),[b,C]=(0,n.useState)({black:0,white:0}),f=(0,n.useRef)(null);(0,n.useEffect)((()=>{if(f.current){var t;const e=f.current,o=((t,e,o,n)=>{const s=new r.Game(6),i=new r.SVGBoard(t,{height:t.clientHeight,size:6});let c=[],l=null;const u=()=>{c=c.filter((t=>s.getStone(t.x,t.y)===("B"===t.type?r.Color.B:r.Color.W)||(i.removeObject(t),!1))),l&&i.removeObject(l),l=null;for(let t=0;t<s.position.size;t+=1)for(let e=0;e<s.position.size;e+=1){const o=s.position.get(t,e);if(o&&!c.some((n=>n.x===t&&n.y===e&&o===("B"===n.type?r.Color.B:r.Color.W)))){const n=new r.FieldBoardObject(o===r.Color.B?"B":"W",t,e);i.addObject(n),c.push(n),null===l?(l=new r.MarkupBoardObject("SQ",t,e,o),i.addObject(l)):l&&(i.removeObject(l),l=!1)}}};let p=null;const d=()=>{p&&(i.removeObject(p),p=null)};return i.on("mousemove",((t,e)=>{if(e&&s.isValid(e.x,e.y)){if(p){if(p.x===e.x&&p.y===e.y)return;i.removeObject(p)}else p=new r.FieldBoardObject(s.turn===r.Color.B?"B":"W");p.setPosition(e.x,e.y),i.addObject(p)}else d()})),i.on("mouseout",d),i.on("click",((t,i)=>{let{x:c,y:l}=i;s.isValid(c,l)&&(d(),s.play(c,l),u(),e(s.turn===r.Color.B?"black":"white"),o(s.position.capCount),n(s.positionStack))})),e(s.turn===r.Color.B?"black":"white"),{syncDown:t=>{if(s.positionStack.length!==t.length){for(;s.positionStack.length<t.length;)s.pushPosition(a(t[s.positionStack.length]));for(;s.positionStack.length>t.length;)s.popPosition();u(),e(s.turn===r.Color.B?"black":"white"),o(s.position.capCount),d()}},pass:()=>{s.pass(),e(s.turn===r.Color.B?"black":"white"),n(s.positionStack)},undo:()=>{s.popPosition()&&(u(),e(s.turn===r.Color.B?"black":"white"),o(s.position.capCount),n(s.positionStack))},resize:()=>{i.setDimensions(t.clientWidth,t.clientHeight)}}})(e,h,C,p);i.current=o;const n=new MutationObserver(o.resize),s=null===(t=e.parentNode)||void 0===t?void 0:t.parentNode;return s&&n.observe(s,{attributes:!0,attributeFilter:["style"]}),()=>{n.disconnect()}}}),[p]);return(0,l.jsxs)("div",{className:"GoBoard-container",children:[(0,l.jsxs)("div",{className:"GoBoard-toolbar",children:["Next Turn: ","black"===d?"Black":"White",(0,l.jsx)("button",{type:"button",onClick:()=>{i.current&&i.current.pass()},children:"Pass"}),(0,l.jsx)("button",{type:"button",onClick:()=>{i.current&&i.current.undo()},children:"Undo"}),(0,l.jsxs)("div",{children:["Capture Count: Black ",b.black,", White ",b.white]})]}),(0,l.jsx)("div",{className:"GoBoard-canvas",ref:f})]})})),p=u}}]);
//# sourceMappingURL=357.1407e47e.chunk.js.map