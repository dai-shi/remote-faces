(this["webpackJsonpremote-faces-web"]=this["webpackJsonpremote-faces-web"]||[]).push([[4],{1077:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(46),r=n(15),c=n(234),i=new Map,o=function(e,t,n){var a="".concat(e,"_").concat(t),r=i.get(a);if(!r){var o=new Set,u=new Set,s=new Set,l=new Set;r={room:Object(c.b)(e,t,(function(e){o.forEach((function(t){t(e)}))}),(function(e){u.forEach((function(t){t(e)}))}),(function(e,t){s.forEach((function(n){n(e,t)}))}),(function(e,t){l.forEach((function(n){(0,n.listener)(e,t)}))})),networkStatusListeners:o,newPeerListeners:u,dataListeners:s,trackListeners:l,count:0},i.set(a,r)}if(n.networkStatusListener&&r.networkStatusListeners.add(n.networkStatusListener),n.newPeerListener&&r.newPeerListeners.add(n.newPeerListener),n.dataListener&&r.dataListeners.add(n.dataListener),n.trackListener){var d=new Set(Array.from(r.trackListeners).map((function(e){return e.mediaType}))),m=d.size;r.trackListeners.add(n.trackListener),d.add(n.trackListener.mediaType),m!==d.size&&r.room.acceptMediaTypes(Array.from(d))}r.count+=1;var f=r;return{broadcastData:r.room.broadcastData,sendData:r.room.sendData,addTrack:r.room.addTrack,removeTrack:r.room.removeTrack,unregister:function(){if(n.networkStatusListener&&f.networkStatusListeners.delete(n.networkStatusListener),n.newPeerListener&&f.newPeerListeners.delete(n.newPeerListener),n.dataListener&&f.dataListeners.delete(n.dataListener),n.trackListener){var e=new Set(Array.from(f.trackListeners).map((function(e){return e.mediaType}))),t=e.size;f.trackListeners.delete(n.trackListener),t!==(e=new Set(Array.from(f.trackListeners).map((function(e){return e.mediaType})))).size&&f.room.acceptMediaTypes(Array.from(e))}f.count-=1,f.count<=0&&(f.room.dispose(),i.delete(a))}}},u=function(e,t,n){var c=Object(r.useState)(),i=Object(a.a)(c,2),u=i[0],s=i[1];if(u&&"UNKNOWN_ERROR"===u.type)throw new Error("Network Error: ".concat(u.err.message));return Object(r.useEffect)((function(){return o(e,t,{networkStatusListener:function(e){s(e),n&&n(e)}}).unregister}),[e,t,n]),u},s=function(e,t,n){Object(r.useEffect)((function(){var a=o(e,t,{newPeerListener:function(e){n((function(t){return c(t,e)}))}}),r=a.unregister,c=a.sendData;return r}),[e,t,n])},l=function(e,t){var n=Object(r.useRef)(),a=Object(r.useCallback)((function(){n.current&&n.current.apply(n,arguments)}),[]);return Object(r.useEffect)((function(){var a=o(e,t,{});return n.current=a.broadcastData,a.unregister}),[e,t]),a},d=function(e,t,n){Object(r.useEffect)((function(){return o(e,t,{dataListener:n}).unregister}),[e,t,n])},m=function(e,t,n,c){var i=Object(r.useState)({}),u=Object(a.a)(i,2),s=u[0],l=u[1];return Object(r.useEffect)((function(){if(c){var a=o(e,t,{trackListener:{mediaType:c,listener:n}});return l({addTrack:function(e){return a.addTrack(c,e)},removeTrack:function(e){return a.removeTrack(c,e)}}),function(){l({}),a.unregister()}}}),[e,t,n,c]),s}},1080:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(46),r=n(15),c=n(55),i=n(1077),o=[],u=function(e){var t={};return o.forEach((function(n){n.roomId===e&&(t[n.userId]=n.nickname)})),t},s=function(e,t){var n=Object(r.useState)((function(){return u(e)})),s=Object(a.a)(n,2),l=s[0],d=s[1];return Object(i.b)(e,t,Object(r.useCallback)((function(t,n){if(a=t,Object(c.a)(a)&&Object(c.a)(a.info)&&"string"===typeof a.info.nickname){var a,r=o.findIndex((function(t){return t.roomId===e&&t.userId===n.userId})),i=Date.now();r>=0?(o[r].nickname!==t.info.nickname&&(o[r].nickname=t.info.nickname),o[r].lastUpdated=i):o.push({roomId:e,userId:n.userId,nickname:t.info.nickname,lastUpdated:i});for(var s=o.length-1;s>=0;s-=1)o[s].lastUpdated+6e5<i&&o.splice(s,1);d((function(t){var n=u(e),a=Object.keys(n);return a.length===Object.keys(t).length&&a.every((function(e){return n[e]===t[e]}))?t:n}))}}),[e])),l}},1081:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return m}));var a=n(0),r=n.n(a),c=n(46),i=n(12),o=n(54),u=function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,o,u,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?{video:{deviceId:t}}:{video:!0},e.next=3,navigator.mediaDevices.getUserMedia(n);case 3:return a=e.sent,i=a.getVideoTracks(),o=Object(c.a)(i,1),u=o[0],s=function(){u.stop()},e.abrupt("return",{stream:a,dispose:s});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,i,u,s,l,d,m,f,b,v,p,O,g,j,k,h,E;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?{video:{deviceId:t}}:{video:!0},e.next=3,navigator.mediaDevices.getUserMedia(n);case 3:return a=e.sent,i=a.getVideoTracks(),u=Object(c.a)(i,1),s=u[0],(l=document.getElementById("internal-video")).style.display="block",l.srcObject=a,e.next=10,Object(o.a)(1e3);case 10:return d=l.videoWidth,m=l.videoHeight,f=document.getElementById("internal-canvas"),b=f.getContext("2d"),72,72,f.width=72,f.height=72,v=Math.max(72/d,72/m),p=Math.min(d,72/v),O=Math.min(m,72/v),g=(d-p)/2,j=(m-O)/2,function e(){b.drawImage(l,g,j,p,O,0,0,72,72),k=setTimeout(e,1e3/15)}(),h=f.captureStream(),E=function(){l.style.display="none",clearTimeout(k),s.stop(),h.getVideoTracks()[0].stop()},e.abrupt("return",{stream:h,dispose:E});case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(i.a)(r.a.mark((function e(t){var n,a,c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,(n=document.createElement("video")).srcObject=new MediaStream([t]),a=0;case 4:if(!(a<50)){e.next=14;break}return e.next=7,Object(o.a)(100);case 7:if(c=n.videoWidth,i=n.videoHeight,!(c>0&&i>0)){e.next=11;break}return e.abrupt("return",72===c&&72===i);case 11:a+=1,e.next=4;break;case 14:return e.abrupt("return",!0);case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),d=new WeakMap,m=function(e){if(d.has(e))return d.get(e);var t=l(e);return d.set(e,t),t}},1087:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var a=n(0),r=n.n(a),c=n(12),i=n(46),o=n(15),u=function(){var e=Object(c.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return t=e.sent,n=t.filter((function(e){return"videoinput"===e.kind})).map((function(e){return{label:e.label,deviceId:e.deviceId}})),e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(c.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return t=e.sent,n=t.filter((function(e){return"audioinput"===e.kind})).map((function(e){return{label:e.label,deviceId:e.deviceId}})),e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},d=function(){var e=Object(o.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(o.useEffect)((function(){Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:t=e.sent,a(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n}},1089:function(e,t,n){},1090:function(e,t,n){},1092:function(e,t,n){},1099:function(e,t,n){},1100:function(e,t,n){},1101:function(e,t,n){},1102:function(e,t,n){},1103:function(e,t,n){},1113:function(e,t,n){"use strict";n.r(t),n.d(t,"SingleRoom",(function(){return ie}));var a=n(46),r=n(15),c=n.n(r),i=(n(1089),n(85)),o=function(e,t){try{window.localStorage.setItem(e,t)}catch(n){console.info("Failed to save string to localStorage",n)}},u=function(e){try{return window.localStorage.getItem(e)||""}catch(t){return""}},s=n(1080),l=n(154),d=(n(1090),n(0)),m=n.n(d),f=n(12),b=n(86),v=n(55),p=n(54),O=function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,r,c,i,o,u,s,l,d,f,b;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof ImageCapture){e.next=21;break}return a=new ImageCapture(n),e.next=4,Object(p.a)(2e3);case 4:return e.prev=4,e.next=7,a.takePhoto();case 7:return c=e.sent,e.next=10,createImageBitmap(c);case 10:r=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(4),e.next=17,a.grabFrame();case 17:r=e.sent;case 18:return i=r.width,o=r.height,e.abrupt("return",{srcImg:r,srcW:i,srcH:o});case 21:return(u=document.getElementById("internal-video")).style.display="block",s=u.srcObject,l=function(){u.srcObject=s},u.srcObject=t,e.next=28,Object(p.a)(2e3);case 28:return d=u,f=u.videoWidth,b=u.videoHeight,e.abrupt("return",{srcImg:d,srcW:f,srcH:b,revert:l});case 32:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,c,i,o,u,s,l,d,f,b,v,p,g,j,k,h,E,y;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?{video:{deviceId:t}}:{video:!0},e.next=3,navigator.mediaDevices.getUserMedia(n);case 3:return r=e.sent,c=r.getVideoTracks(),i=Object(a.a)(c,1),o=i[0],u=document.getElementById("internal-canvas"),s=u.getContext("2d"),l=72,d=72,u.width=l,u.height=d,e.next=13,O(r,o);case 13:return f=e.sent,b=f.srcImg,v=f.srcW,p=f.srcH,g=f.revert,j=Math.max(l/v,d/p),k=Math.min(v,l/j),h=Math.min(p,d/j),E=(v-k)/2,y=(p-h)/2,s.drawImage(b,E,y,k,h,0,0,l,d),g&&g(),o.stop(),e.abrupt("return",u.toDataURL("image/jpeg"));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=n(1077),k=function(e){return Object(v.a)(e)&&"string"===typeof e.image&&function(e){return Object(v.a)(e)&&"string"===typeof e.nickname&&"string"===typeof e.message&&"boolean"===typeof e.liveMode}(e.info)},h=n(103),E=n(1109),y=n(1110),I=n(1081),S=function(){var e=Object(f.a)(m.a.mark((function e(t){var n,r,c,i,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?{audio:{deviceId:t}}:{audio:!0},e.next=3,navigator.mediaDevices.getUserMedia(n);case 3:return r=e.sent,c=r.getAudioTracks(),i=Object(a.a)(c,1),o=i[0],e.next=7,o.applyConstraints({echoCancellation:!0,echoCancellationType:{ideal:"system"},noiseSuppression:{ideal:!0}});case 7:return u=function(){o.stop()},e.abrupt("return",{stream:r,dispose:u});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(e,t,n){var a=t||new MediaStream;return a.addTrack(e),a.dispatchEvent(new MediaStreamTrackEvent("addtrack",{track:e})),e.addEventListener("ended",(function(){a.removeTrack(e),0===a.getTracks().length&&n(a)})),a},C=c.a.memo((function(e){var t=e.image,n=e.nickname,a=e.statusMesg,r=e.obsoleted,i=e.liveMode,o=e.stream,u=e.muted,s=e.micOn,d=e.speakerOn;return c.a.createElement("div",{className:"FaceImages-card",style:{opacity:r?.2:1}},i&&!r&&o?c.a.createElement("video",{className:"FaceImages-photo",ref:function(e){e&&e.srcObject!==o&&(e.srcObject=o)},autoPlay:!0,playsInline:!0,muted:u}):c.a.createElement("img",{src:t||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=",className:"FaceImages-photo",alt:"myself"}),c.a.createElement("div",{className:"FaceImages-name"},n),c.a.createElement("div",{className:"FaceImages-mesg",title:Object(l.a)(a)[1]?a:"(No status message)"},Object(l.a)(a)[0]),i&&!r&&o&&c.a.createElement("div",{className:"FaceImages-live-indicator",title:"Live Mode On"},"\u25c9"),i&&!r&&!o&&c.a.createElement("div",{className:"FaceImages-live-indicator",title:"Live Mode Available"},"\u25ce"),i&&!r&&c.a.createElement("div",{className:"FaceImages-mic-speaker-icons"},s&&c.a.createElement("span",{title:"Mic On"},"\ud83c\udfa4"),d&&c.a.createElement("span",{title:"Speaker On"},"\ud83d\udd08")))})),x=c.a.memo((function(e){var t=e.roomId,n=e.userId,i=e.nickname,o=e.statusMesg,u=e.liveMode,s=e.micOn,d=e.speakerOn,v=e.videoDeviceId,p=e.audioDeviceId,O=function(e,t,n,c,i,o,u,s){var d=Object(r.useState)(),v=Object(a.a)(d,2),p=v[0],O=v[1],h=Object(r.useState)([]),E=Object(a.a)(h,2),y=E[0],I=E[1],S=Object(r.useState)(),w=Object(a.a)(S,2),C=w[0],x=w[1];if(C)throw C;var M=Object(r.useRef)();Object(j.e)(e,t,Object(r.useCallback)((function(e){M.current&&e(M.current)}),[]));var L=Object(j.a)(e,t);return Object(j.b)(e,t,Object(r.useCallback)((function(e,t){if(k(e)){var n=Object(b.a)(Object(b.a)({},e),{},{userId:t.userId,received:Date.now(),obsoleted:!1,peerIndex:t.peerIndex});I((function(e){return e.find((function(e){return e.userId===n.userId}))?e.map((function(e){return e.userId===n.userId?n:e})):[].concat(Object(l.a)(e),[n])}))}}),[])),Object(j.d)(e,t,Object(r.useCallback)((function(e){if(e&&"CONNECTION_CLOSED"===e.type){var t=e.peerIndex;I((function(e){var n=!1,a=e.map((function(e){return e.peerIndex===t?(n=!0,Object(b.a)(Object(b.a)({},e),{},{obsoleted:!0})):e}));return n?a:e}))}}),[])),Object(r.useEffect)((function(){var e,t=function(){var e=Date.now()-12e4,t=Date.now()-6e5;I((function(n){var a=!1,r=n.map((function(n){return n.received<e&&!n.obsoleted?(a=!0,Object(b.a)(Object(b.a)({},n),{},{obsoleted:!0})):n.received<t&&n.obsoleted?(a=!0,null):n})).filter((function(e){return e}));return a?r:n}))},a=!1,r=function(){var l=Object(f.a)(m.a.mark((function l(){var d,f;return m.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(!a){l.next=2;break}return l.abrupt("return");case 2:return l.prev=2,t(),l.next=6,g(s);case 6:if(d=l.sent,!a){l.next=9;break}return l.abrupt("return");case 9:O(d),L(f={image:d,info:{nickname:n,message:c,liveMode:i,micOn:o,speakerOn:u}}),M.current=f,l.next=19;break;case 16:l.prev=16,l.t0=l.catch(2),x(l.t0);case 19:e=setTimeout(r,12e4);case 20:case"end":return l.stop()}}),l,null,[[2,16]])})));return function(){return l.apply(this,arguments)}}();return r(),function(){a=!0,clearTimeout(e)}}),[e,t,s,n,c,i,o,u,L]),{myImage:p,roomImages:y}}(t,n,i,o,u,s,d,v),x=O.myImage,M=O.roomImages,L=function(e,t,n,c,i,o,u){var s=Object(r.useState)(null),l=Object(a.a)(s,2),d=l[0],v=l[1],p=Object(r.useState)({}),O=Object(a.a)(p,2),g=O[0],k=O[1],C=Object(r.useRef)(!0);Object(r.useEffect)((function(){return function(){C.current=!1}}),[]);var x=Object(r.useCallback)(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="video"===t.kind,!e.t0){e.next=5;break}return e.next=4,Object(I.c)(t);case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:a=function(e){C.current&&k((function(t){var a=n.userId,r=t[a],c=Object(E.a)(t,[a].map(y.a));return r===e?c:t}))},k((function(e){var r=e[n.userId],c=w(t,r,a);return r===c?e:Object(b.a)(Object(b.a)({},e),{},Object(h.a)({},n.userId,c))}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),M=Object(j.c)(e,t,x,n?"faceVideo":void 0),L=M.addTrack,N=M.removeTrack,A=Object(j.c)(e,t,x,c?"faceAudio":void 0),T=A.addTrack,D=A.removeTrack;return Object(r.useEffect)((function(){var e=null;return n&&L&&N&&Object(f.a)(m.a.mark((function t(){var n,r,c,i,u,s,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(I.a)(o);case 2:n=t.sent,r=n.stream,c=n.dispose,i=r.getVideoTracks(),u=Object(a.a)(i,1),s=u[0],L(s),l=function(e){C.current&&v((function(t){return t===e?null:t}))},v((function(e){return w(s,e,l)})),e=function(){N(s),c(),s.dispatchEvent(new Event("ended"))};case 10:case"end":return t.stop()}}),t)})))(),function(){e&&e()}}),[e,n,o,L,N]),Object(r.useEffect)((function(){var e=null;return c&&T&&D&&Object(f.a)(m.a.mark((function t(){var n,r,c,i,o,s,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(u);case 2:n=t.sent,r=n.stream,c=n.dispose,i=r.getAudioTracks(),o=Object(a.a)(i,1),s=o[0],T(s),l=function(e){C.current&&v((function(t){return t===e?null:t}))},v((function(e){return w(s,e,l)})),e=function(){D(s),c(),s.dispatchEvent(new Event("ended"))};case 10:case"end":return t.stop()}}),t)})))(),function(){e&&e()}}),[e,c,u,T,D]),Object(r.useEffect)((function(){if(d){d.getAudioTracks().forEach((function(e){e.enabled=i}));var e=function(e){var t=e.track;"audio"===t.kind&&(t.enabled=i)};return d.addEventListener("addtrack",e),function(){d.removeEventListener("addtrack",e)}}}),[d,i]),{faceStream:d,faceStreamMap:g}}(t,n,u,u,s,v,p),N=L.faceStream,A=L.faceStreamMap;return c.a.createElement(c.a.Fragment,null,c.a.createElement(C,{image:x,nickname:i,statusMesg:o,liveMode:u,stream:N||void 0,muted:!0}),M.map((function(e){return c.a.createElement(C,{key:e.userId,image:e.image,nickname:e.info.nickname,statusMesg:e.info.message,obsoleted:e.obsoleted,liveMode:e.info.liveMode,stream:u&&A[e.userId]||void 0,muted:!d,micOn:e.info.micOn,speakerOn:e.info.speakerOn})})))})),M=n(1091),L=n.n(M),N=(n(1092),n(53)),A=function(e){return Array.isArray(e)&&2===e.length&&"string"===typeof e[0]&&"number"===typeof e[1]},T=function(e){return Object(v.a)(e)&&"string"===typeof e.nickname&&"string"===typeof e.messageId&&"number"===typeof e.createdAt&&"string"===typeof e.text&&("undefined"===typeof e.inReplyTo||"string"===typeof e.inReplyTo)&&("undefined"===typeof e.replies||function(e){return Array.isArray(e)&&e.every(A)}(e.replies))},D=function(e,t){var n=t[1]-e[1];return 0===n?e[0].length-t[0].length:n},P=function(e,t,n){var c=Object(r.useState)([]),i=Object(a.a)(c,2),o=i[0],u=i[1],s=Object(r.useRef)(o);Object(r.useEffect)((function(){s.current=o}));var d=Object(r.useCallback)((function(e){if(e.inReplyTo){var t=e.text,n=e.inReplyTo;u((function(e){return e.map((function(e){if(e.messageId===n){var a=new Map(e.replies);a.set(t,(a.get(t)||0)+1);var r=Object(l.a)(a.entries());return r.sort(D),Object(b.a)(Object(b.a)({},e),{},{replies:r})}return e}))}))}else u((function(t){if(t.some((function(t){return t.messageId===e.messageId})))return t;var n=[e].concat(Object(l.a)(t));return n.length>100&&n.pop(),n.sort((function(e,t){return t.createdAt-e.createdAt})),n}))}),[]);Object(j.e)(e,t,Object(r.useCallback)((function(e){s.current.forEach((function(t){e({chat:t})}))}),[]));var m=Object(j.a)(e,t);Object(j.b)(e,t,Object(r.useCallback)((function(e){var t;t=e,Object(v.a)(t)&&T(t.chat)&&d(e.chat)}),[d]));var f=Object(r.useCallback)((function(e){var t={nickname:n,messageId:Object(N.f)(),createdAt:Date.now(),text:e};m({chat:t}),d(t)}),[m,n,d]),p=Object(r.useCallback)((function(e,t){var a={nickname:n,messageId:Object(N.f)(),createdAt:Date.now(),text:e,inReplyTo:t};m({chat:a}),d(a)}),[m,n,d]);return{chatList:o,sendChat:f,replyChat:p}},R=(n(1093),n(1084)),U=R.b,_=n(1097),F=n.n(_),V=n(1098),z=n.n(V),B=(n(1099),{toolbar:["specialCharacters","|","bold","italic","link","blockQuote","|","imageUpload","insertTable","mediaEmbed","|","undo","redo"],balloonToolbar:["heading","|","bulletedList","numberedList","indent","outdent"],link:{addTargetToExternalLinks:!0}}),W=c.a.memo((function(e){var t=e.registerClear,n=e.onChange;return c.a.createElement(F.a,{editor:z.a,config:B,onInit:function(e){t((function(){e.setData("")})),function(e){e.plugins.get("SpecialCharacters").addItems("Emoji",[{title:"smiley face",character:"\ud83d\ude0a"},{title:"rocket",character:"\ud83d\ude80"},{title:"wind blowing face",character:"\ud83c\udf2c\ufe0f"},{title:"floppy disk",character:"\ud83d\udcbe"},{title:"heart",character:"\u2764\ufe0f"}])}(e)},onChange:function(e,t){var a=t.getData();n(a)}})})),H=c.a.memo((function(e){var t,n=e.item,i=e.replyChat,o=Object(r.useState)(!1),u=Object(a.a)(o,2),s=u[0],l=u[1],d=function(e){return i(e,n.messageId)};return c.a.createElement("li",{key:n.messageId,className:"MomentaryChat-listPart"},s&&c.a.createElement(U,{onSelect:function(e){d(e.native),l(!1)},style:{width:"100%"}}),c.a.createElement("div",{className:"MomentaryChat-listPart-header"},c.a.createElement("div",{className:"MomentaryChat-iconButton-container"},c.a.createElement("div",{className:"MomentaryChat-iconButton"},c.a.createElement("button",{type:"button",onClick:function(){l(!s)}},"+"))),c.a.createElement("span",{className:"MomentaryChat-nickname"},n.nickname||"No Name"),c.a.createElement("span",{className:"MomentaryChat-time"},function(e){return new Date(e.createdAt).toLocaleString().split(" ")[1].slice(0,-3)}(n))),c.a.createElement("div",{className:"MomentaryChat-text ck-content",dangerouslySetInnerHTML:(t=n.text,{__html:L.a.sanitize(t,{ADD_ATTR:["target"]})})}),(n.replies||[]).map((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return c.a.createElement("button",{key:n,className:"MomentaryChat-icon",type:"button",onClick:function(){return d(n)}},n," ",r)})))})),Q=c.a.memo((function(e){var t,n=e.chatList,a=e.replyChat,i=Object(r.useRef)(null),o=null===(t=n[0])||void 0===t?void 0:t.messageId;return Object(r.useEffect)((function(){i.current&&o&&(i.current.scrollTop=i.current.scrollHeight)}),[o]),c.a.createElement("ul",{className:"MomentaryChat-list",ref:i},n.map((function(e){return c.a.createElement(H,{key:e.messageId,item:e,replyChat:a})})))})),J=c.a.memo((function(e){var t=e.roomId,n=e.userId,i=e.nickname,o=Object(r.useRef)(null),u=P(t,n,i),s=u.chatList,l=u.sendChat,d=u.replyChat,m=Object(r.useRef)(),f=Object(r.useState)(""),b=Object(a.a)(f,2),v=b[0],p=b[1];return c.a.createElement("div",{className:"MomentaryChat-container",ref:o},c.a.createElement(Q,{chatList:s,replyChat:d}),c.a.createElement("div",{className:"MomentaryChat-editor"},c.a.createElement(W,{registerClear:function(e){m.current=e},onChange:p})),c.a.createElement("div",{className:"MomentaryChat-button"},c.a.createElement("button",{type:"button",onClick:function(){v&&(l(v),p(""),m.current&&m.current())},disabled:!v},"Send")))})),K=(n(1100),c.a.memo((function(e){var t=e.liveMode,n=e.setLiveMode,a=e.micOn,r=e.setMicOn,i=e.speakerOn,o=e.setSpeakerOn,u=e.secondColumnOpen,s=e.setSecondColumnOpen;return c.a.createElement("div",{className:"ControlPanel-container"},c.a.createElement("button",{type:"button",onClick:function(){return n((function(e){return!e}))},title:t?"Disable Live Mode":"Enable Live Mode"},"\ud83c\udfa5",!t&&c.a.createElement("span",{className:"ControlPanel-disabled"},"\u274c")),c.a.createElement("button",{type:"button",onClick:function(){return s((function(e){return!e}))},title:u?"Close Right Pane":"Open Right Pane"},u?c.a.createElement(c.a.Fragment,null,"\u25c0"):c.a.createElement(c.a.Fragment,null,"\u25b6")),c.a.createElement("button",{type:"button",onClick:function(){return r((function(e){return!e}))},title:a?"Disable Mic":"Enable Mic"},"\ud83c\udfa4",!a&&c.a.createElement("span",{className:"ControlPanel-disabled"},"\u274c")),c.a.createElement("button",{type:"button",onClick:function(){return o((function(e){return!e}))},title:i?"Disable Speaker":"Enable Speaker"},c.a.createElement(c.a.Fragment,null,"\ud83d\udd08"),!i&&c.a.createElement("span",{className:"ControlPanel-disabled"},"\u274c")))}))),Y=(n(1101),n(1087)),G="true"!==u("config_hidden"),q="remote-faces://".concat(window.location.href.replace(/^https:\/\//,"")),X=c.a.memo((function(e){var t=e.initialText,n=e.onUpdate,i=e.buttonLabel,o=e.placeholder,u=e.clearOnUpdate,s=Object(r.useState)(t),l=Object(a.a)(s,2),d=l[0],m=l[1];return c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),d&&(n(d),u&&m(""))}},c.a.createElement("input",{value:d,onChange:function(e){return m(e.target.value)},placeholder:o}),i&&c.a.createElement("button",{type:"submit",disabled:!d},i))})),Z=c.a.memo((function(e){var t=e.roomId,n=e.userId,i=e.nickname,u=e.setNickname,s=e.videoDeviceId,l=e.setVideoDeviceId,d=e.audioDeviceId,m=e.setAudioDeviceId,f=Object(r.useState)(G),b=Object(a.a)(f,2),v=b[0],p=b[1];Object(r.useEffect)((function(){o("config_hidden",v?"false":"true")}),[v]);var O=Object(Y.b)(),g=Object(Y.a)(),k=Object(j.d)(t,n);return c.a.createElement("div",{className:"SettingPanel-container"},c.a.createElement("button",{type:"button",className:"SettingPanel-config-toggle",onClick:function(){return p((function(e){return!e}))}},"Setting",v?c.a.createElement(c.a.Fragment,null,"\u25bc"):c.a.createElement(c.a.Fragment,null,"\u25b6")),v&&c.a.createElement("div",{className:"SettingPanel-config"},c.a.createElement("div",{className:"SettingPanel-config-row"},c.a.createElement("span",{title:"Share this link with your colleagues"},"Room Link:"," "),c.a.createElement("input",{value:window.location.href,readOnly:!0})," ",c.a.createElement("a",{href:q,title:"Open this link in the desktop app"},"Open App")),c.a.createElement("div",{className:"SettingPanel-config-row"},"Your Name:"," ",c.a.createElement(X,{initialText:i,onUpdate:function(e){u(e),o("nickname",e)},placeholder:"Enter your name",buttonLabel:"Set"})),c.a.createElement("div",{className:"SettingPanel-config-row"},"Select Camera:"," ",c.a.createElement("select",{value:s,onChange:function(e){l(e.target.value),o("faceimage_video_device_id",e.target.value)}},O.map((function(e){return c.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label)})))),c.a.createElement("div",{className:"SettingPanel-config-row"},"Select Mic:"," ",c.a.createElement("select",{value:d,onChange:function(e){m(e.target.value),o("faceimage_audio_device_id",e.target.value)}},g.map((function(e){return c.a.createElement("option",{key:e.deviceId,value:e.deviceId},e.label)})))),c.a.createElement("div",{className:"SettingPanel-status"},JSON.stringify(k))))})),$=(n(1102),c.a.memo((function(e){var t=e.initialText,n=e.onUpdate,i=e.buttonLabel,o=e.placeholder,u=e.clearOnUpdate,s=Object(r.useState)(t),l=Object(a.a)(s,2),d=l[0],m=l[1];return c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),d&&(n(d),u&&m(""))}},c.a.createElement("input",{value:d,onChange:function(e){return m(e.target.value)},placeholder:o}),i&&c.a.createElement("button",{type:"submit",disabled:!d},i))}))),ee=c.a.memo((function(e){var t=e.emoji,n=e.setEmoji,i=e.setStatusMesg,o=Object(r.useState)(!1),u=Object(a.a)(o,2),s=u[0],l=u[1];return c.a.createElement("div",{className:"UserStatus-container"},c.a.createElement("div",{className:"UserStatus-status-area"},c.a.createElement("div",{className:"UserStatus-emoji"},c.a.createElement("button",{type:"button",onClick:function(){l(!s)}},t?c.a.createElement(R.a,{emoji:t,size:10}):":)")),t&&c.a.createElement("div",{className:"UserStatus-statusmesg"},c.a.createElement($,{initialText:"",onUpdate:i,placeholder:"Enter status message...",buttonLabel:"Set"})),c.a.createElement("button",{type:"button",onClick:function(){n(null),i(""),l(!1)},disabled:!t},"Clear")),s&&c.a.createElement(U,{onSelect:function(e){n(e),l(!1)},style:{width:"100%"}}))})),te=(n(1103),{Welcome:c.a.lazy((function(){return n.e(10).then(n.bind(null,1112))})),"Screen Share":c.a.lazy((function(){return n.e(8).then(n.bind(null,1114))})),"Video Share":c.a.lazy((function(){return n.e(9).then(n.bind(null,1115))})),"White Board":c.a.lazy((function(){return n.e(5).then(n.bind(null,1116))})),"Go Board":c.a.lazy((function(){return Promise.all([n.e(11),n.e(6)]).then(n.bind(null,1117))}))}),ne=c.a.memo((function(e){var t=e.roomId,n=e.userId,i=e.nickname,o=Object(r.useState)("Welcome"),u=Object(a.a)(o,2),s=u[0],l=u[1];return c.a.createElement("div",{className:"SelectivePane-container"},c.a.createElement("div",{className:"SelectivePane-select"},"\u2630",c.a.createElement("select",{value:s,onChange:function(e){return l(e.target.value)}},Object.keys(te).map((function(e){return c.a.createElement("option",{key:e,value:e},e)})))),Object(r.createElement)(te[s],{roomId:t,userId:n,nickname:i}))})),ae=u("nickname"),re=u("faceimage_video_device_id"),ce=u("faceimage_audio_device_id"),ie=c.a.memo((function(e){var t=e.roomId,n=e.userId,o=Object(r.useState)(ae),u=Object(a.a)(o,2),l=u[0],d=u[1],m=Object(r.useState)(""),f=Object(a.a)(m,2),b=f[0],v=f[1],p=Object(r.useState)(null),O=Object(a.a)(p,2),g=O[0],j=O[1];Object(r.useEffect)((function(){Object(i.e)(t)}),[t]);var k=Object(r.useState)(re),h=Object(a.a)(k,2),E=h[0],y=h[1],I=Object(r.useState)(ce),S=Object(a.a)(I,2),w=S[0],C=S[1],M=Object(r.useState)(!1),L=Object(a.a)(M,2),N=L[0],A=L[1],T=Object(r.useState)(!1),D=Object(a.a)(T,2),P=D[0],R=D[1],U=Object(r.useState)(!1),_=Object(a.a)(U,2),F=_[0],V=_[1],z=Object(r.useState)(!0),B=Object(a.a)(z,2),W=B[0],H=B[1],Q=Object(r.useState)(!0),Y=Object(a.a)(Q,2),G=Y[0],q=Y[1];return Object(s.a)(t,n),c.a.createElement("div",{className:"SingleRoom-container"},c.a.createElement("div",{className:"SingleRoom-1st-column"},c.a.createElement(K,{liveMode:N,setLiveMode:A,micOn:P,setMicOn:R,speakerOn:F,setSpeakerOn:V,secondColumnOpen:W,setSecondColumnOpen:H}),c.a.createElement(x,{roomId:t,userId:n,videoDeviceId:E,audioDeviceId:w,nickname:l,statusMesg:"".concat((null===g||void 0===g?void 0:g.native)||" ").concat(b),liveMode:N,micOn:P,speakerOn:F})),c.a.createElement("div",{className:"SingleRoom-2nd-column",style:{width:W?"inherit":"0"}},c.a.createElement("button",{type:"button",className:"SingleRoom-toggle-3rd-column",onClick:function(){return q((function(e){return!e}))},title:G?"Close Right Pane":"Open Right Pane"},G?c.a.createElement(c.a.Fragment,null,"\u25c0"):c.a.createElement(c.a.Fragment,null,"\u25b6")),c.a.createElement(ee,{emoji:g,setEmoji:j,setStatusMesg:v}),c.a.createElement(Z,{roomId:t,userId:n,nickname:l,setNickname:d,videoDeviceId:E,setVideoDeviceId:y,audioDeviceId:w,setAudioDeviceId:C}),c.a.createElement(J,{roomId:t,userId:n,nickname:l})),c.a.createElement("div",{className:"SingleRoom-3rd-column",style:{display:G?"inherit":"none"}},c.a.createElement(ne,{roomId:t,userId:n,nickname:l})))}));t.default=ie}}]);
//# sourceMappingURL=4.c2fb2997.chunk.js.map